"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128],{1691:(e,t,s)=>{s.d(t,{O:()=>a,v:()=>l});var n=s(6784);let l=(0,n.F)({results:{}},{store:!0,compress:!0,namespace:"research"}),a=(0,n.F)({activeSearch:"",triggerSearch:""})},3452:(e,t,s)=>{s.r(t),s.d(t,{default:()=>eb,usePageState:()=>eg});var n=s(3365),l=s(627),a=s(1521),r=s(8217),i=s(6784);let o=(0,i.F)({activeNotepadId:null,showHelp:!1}),c=(0,i.F)({hasFocus:!1,selection:{chars:0,words:0,isCurrentLine:!1},documentStats:{chars:0,words:0}});function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Date.now();return{id:"notepad-".concat(Date.now()),name:function(e){let t=new Set(e.map(e=>e.name)),s=1,n="Notepad ".concat(s);for(;t.has(n);)s++,n="Notepad ".concat(s);return n}(e),content:"",createdAt:t,updatedAt:t}}function u(e){return 0===e.replace(/<br\s*\/?>/gi,"").trim().length}function h(e){let{children:t}=e,[s,i]=(0,a.useState)(!0),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),m=(0,l.useSearchParams)(),x=(0,l.useRouter)(),{setActiveView:p}=eg(),{setShowHelp:g}=o(),f=async()=>{let e=(0,r._9)();if(!(null==e?void 0:e.refresh_token))return console.log("[Token Refresh] No refresh token available"),!1;try{console.log("[Token Refresh] Attempting to refresh access token...");let t=await fetch("/api/auth/ebay/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e.refresh_token})}),s=await t.json();if(s.success)return console.log("[Token Refresh] Token refreshed successfully"),(0,r.O5)(s.data),!0;return console.error("[Token Refresh] Failed - API returned error:",s),!1}catch(e){return console.error("[Token Refresh] Failed - Network or parsing error:",e),!1}},b=async()=>{let e=(0,r._9)();return!!e&&(!!(e&&e.expiryTime&&e.expiryTime-Date.now()>3e5)||(await f()?b():(h("Your session has expired. Please log in again."),(0,r.O5)(null),!1)))};return((0,a.useEffect)(()=>{(async()=>{d(await b()),i(!1)})()},[]),(0,a.useEffect)(()=>{let e=m.get("success"),t=m.get("access_token"),s=m.get("refresh_token"),n=m.get("expires_in"),l=m.get("expiryTime"),a=m.get("token_type"),i=m.get("username"),o=m.get("error"),c=async()=>{if(o){h(o),(0,r.O5)(null),d(!1);return}if("true"===e&&t&&i){console.log("[Auth] OAuth callback URL (for debugging):",window.location.href);let e={access_token:t,refresh_token:s,expires_in:parseInt(n),expiryTime:parseInt(l),token_type:a,username:i};(0,r.O5)(e),d(await b()),p("notes"),g(!0),x.replace("/?view=notes")}};(e||o)&&c()},[m,x]),(0,a.useEffect)(()=>{if(!c)return;let e=setInterval(async()=>{d(await b())},6e4);return()=>clearInterval(e)},[c]),(0,a.useEffect)(()=>(window.ebayAuthRefreshToken=async()=>{console.log("[Auth] Manual token refresh triggered");let e=await f();return console.log("[Auth] Manual token refresh result:",e),e&&d(await b()),e},()=>{delete window.ebayAuthRefreshToken}),[]),s)?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-900 relative z-[10000]",children:(0,n.jsx)("div",{className:"bg-slate-800 p-8 rounded-md shadow-md text-slate-100",children:"Loading..."})}):c?t:(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-900 p-4 relative z-[10000]",children:(0,n.jsxs)("div",{className:"bg-slate-800 p-8 rounded-md shadow-md w-full max-w-md",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-slate-100 mb-3",children:"Sign In"}),(0,n.jsx)("div",{className:"text-slate-300 text-base mb-6",children:u?(0,n.jsx)("div",{className:"text-red-400 mb-4",children:u}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"mb-2",children:["This tool is currently in ",(0,n.jsx)("span",{className:"font-bold",children:"closed beta"}),"."]}),(0,n.jsx)("p",{children:"If you'd like to try it, please get in touch with me!"})]})}),(0,n.jsx)("button",{onClick:()=>window.location.href="/api/auth/ebay/authorize",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium p-3 rounded-md transition-colors",children:u?"Try Again":"Sign in with eBay"})]})})}let m=(0,i.F)({activeDraftId:null,cameraZoom:1,selectedDraftIds:[],isMultiSelectMode:!1,triggerAIAssist:null});function x(){return"draft-".concat(Date.now())}function p(e){let{disabled:t=!1}=e,{activeView:s,setActiveView:l}=eg(),{activeDraftId:a,setActiveDraftId:r}=m(),i={notes:{name:"Notes",icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})},inventory:{name:"Inventory",icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M4 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5z"}),(0,n.jsx)("path",{d:"M4 13a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6z"}),(0,n.jsx)("path",{d:"M16 13a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-6z"})]})},research:{name:"Research",icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})},drafts:{name:"Drafts",icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),(0,n.jsx)("circle",{cx:"12",cy:"13",r:"3"})]})},settings:{name:"Settings",icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}};return(0,n.jsx)("div",{className:"flex bg-slate-700 rounded w-full sm:w-auto h-10",children:Object.entries(i).map((e,o)=>{let[c,d]=e;return(0,n.jsxs)("button",{onClick:()=>{"drafts"===c&&"drafts"===s&&a?r(null):l(c)},disabled:t,className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 font-medium transition-all ".concat(s===c?"flex-1 sm:flex-none":"flex-none w-14 sm:flex-none sm:w-auto"," justify-center h-full overflow-hidden ").concat(0===o?"rounded-l":""," ").concat(o===Object.entries(i).length-1?"rounded-r":""," ").concat(t?"opacity-50 cursor-not-allowed":s===c?"bg-blue-600 text-white shadow":"text-slate-300 hover:text-white hover:bg-slate-600"),children:[(0,n.jsx)("span",{className:"shrink-0",children:d.icon}),(0,n.jsx)("span",{className:"overflow-hidden whitespace-nowrap min-w-0 ".concat(s===c?"":"hidden"," sm:block"),children:d.name})]},c)})})}function g(){let{documentStats:e,selection:t,hasFocus:s}=c(),{showHelp:l}=o();return(0,n.jsxs)("div",{className:"flex items-center sm:gap-2 flex-wrap sm:flex-nowrap",children:[(0,n.jsx)("div",{className:"w-full sm:w-auto mb-2 sm:mb-0 sm:mr-4",children:(0,n.jsx)(p,{})}),!l&&(0,n.jsx)("div",{className:"ml-auto text-sm bg-slate-700 text-slate-100 px-3 py-1.5 rounded shadow w-full sm:w-auto",children:s?"".concat(t.isCurrentLine?"Line: ":"Selection: ").concat(t.words," words, ").concat(t.chars," chars"):"Document: ".concat(e.words," words, ").concat(e.chars," chars")})]})}var f=s(2255),b=s(8891);function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[s,n]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),h=(0,a.useRef)(t);h.current=t;let m=(0,a.useRef)(null),x=(0,a.useRef)(null),p=(0,a.useCallback)(async()=>{let t=(0,r.c4)();x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{i(!0)},1e3);try{let s=new URLSearchParams;h.current.limit&&s.set("limit",h.current.limit),h.current.orderBy&&s.set("orderBy",h.current.orderBy),h.current.order&&s.set("order",h.current.order),h.current.fields&&s.set("fields",h.current.fields.join(","));let l="/api/data/".concat(e).concat(s.toString()?"?"+s.toString():""),a=await fetch(l,{headers:{Authorization:"Bearer ".concat(t)}});if(!a.ok){if(404===a.status){x.current&&(clearTimeout(x.current),x.current=null),u("Collection not found: ".concat(a.status)),i(!1);return}console.log("[useCollection ".concat(e,"] Fetch failed with ").concat(a.status,", retrying in 1s...")),m.current=setTimeout(()=>{p()},1e3);return}let{data:r}=await a.json(),o=Object.keys(r).map(e=>({...r[e],_key:e}));x.current&&(clearTimeout(x.current),x.current=null),n(o),u(null),i(!1)}catch(t){console.log("[useCollection ".concat(e,"] Fetch error, retrying in 1s:"),t),m.current=setTimeout(()=>{p()},1e3)}},[e]),g=(0,a.useCallback)(()=>{m.current&&(clearTimeout(m.current),m.current=null),x.current&&(clearTimeout(x.current),x.current=null),i(!0),p()},[p]),y=(0,a.useCallback)(async(t,l)=>{let a=(0,r.c4)(),i=(0,f.f)();c(!0);try{let r=[...s],o=r.findIndex(e=>e._key===t),c=r.findIndex(e=>e._key===l);if(-1===o||-1===c)throw Error("Invalid drag/drop keys");let[d]=r.splice(o,1);r.splice(c,0,d);let h=r.map((e,t)=>({key:e._key,position:t}));n(r.map((e,t)=>({...e,position:t})));let m=await fetch("/api/data/".concat(e,"/reorder"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({updates:h,clientId:i})});if(!m.ok)throw Error("Failed to reorder: ".concat(m.status));u(null)}catch(t){console.error("[useCollection ".concat(e,"] Reorder error:"),t),u(t.message),p()}finally{c(!1)}},[e,s,p]);return(0,a.useEffect)(()=>(p(),()=>{m.current&&(clearTimeout(m.current),m.current=null),x.current&&(clearTimeout(x.current),x.current=null)}),[p]),(0,a.useEffect)(()=>b.z.subscribe({namespace:e},e=>{("collection:changed"===e.type||"refetch"===e.type)&&p()}),[e,p]),{items:s,isLoading:l,isReordering:o,error:d,refetch:g,reorder:y}}var w=s(6473);async function j(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e||"string"!=typeof e)throw Error("namespace must be a non-empty string");if(!t||"string"!=typeof t)throw Error("key must be a non-empty string");if(null==s)throw Error("value cannot be undefined or null");if(null!==n&&"number"!=typeof n)throw Error("position must be a number or null");let l=(0,r.c4)();if(!l)throw Error("No authentication token found");let a={value:s,clientId:(0,f.f)()};null!==n&&(a.position=n);let i=await fetch("/api/data/".concat(e,"/").concat(t),{method:"PUT",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!i.ok){let e=await i.json().catch(()=>({error:"Unknown error"}));throw Error("Failed to create item: ".concat(i.status," - ").concat(e.error||e.message||"Unknown error"))}return{success:!0,timestamp:(await i.json()).timestamp,key:t}}async function v(e,t){if(!e||"string"!=typeof e)throw Error("namespace must be a non-empty string");if(!t||"string"!=typeof t)throw Error("key must be a non-empty string");let s=(0,r.c4)();if(!s)throw Error("No authentication token found");let n=(0,f.f)(),l=await fetch("/api/data/".concat(e,"/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s),"X-Client-Id":n}});if(!l.ok){let e=await l.json().catch(()=>({error:"Unknown error"}));throw Error("Failed to delete item: ".concat(l.status," - ").concat(e.error||e.message||"Unknown error"))}return{success:!0,key:t}}async function k(e,t){if(!Array.isArray(t)||0===t.length)throw Error("keys must be a non-empty array");let s=[],n=[];for(let l of t)try{await v(e,l),s.push(l)}catch(e){console.error("Failed to delete ".concat(l,":"),e),n.push(l)}return{success:0===n.length,deletedKeys:s,failedKeys:n}}var N=s(9838);function C(){var e;let{items:t,isLoading:s,refetch:l,reorder:r}=y("notes",{orderBy:"position",order:"asc",fields:["name","position"]}),{activeNotepadId:i,setActiveNotepadId:c,showHelp:u,setShowHelp:h}=o(),{item:m,setItem:x}=(0,w.H)("notes",i),[p,g]=(0,a.useState)(null),[f,b]=(0,a.useState)(""),[k,C]=(0,a.useState)(null),[S,L]=(0,a.useState)(null),[I,A]=(0,a.useState)(null),[E,T]=(0,a.useState)(null),[M,D]=(0,a.useState)(!1),[P,B]=(0,a.useState)(null),[R,O]=(0,a.useState)(!1);async function F(){O(!0);try{let e=d(t),s=t&&0!==t.length?Math.max(...t.map(e=>{var t;return null!=(t=e.position)?t:0}))+1:0;await j("notes",e.id,e,s),await l(),c(e.id)}catch(e){console.error("Error creating notepad:",e),alert("Failed to create notepad")}finally{O(!1)}}async function _(){if(P)try{await v("notes",P),B(null),D(!1)}catch(e){console.error("Error deleting notepad:",e),alert("Failed to delete notepad")}}function U(){if(!p||!f.trim()||!m){g(null),b("");return}x({...m,name:f.trim(),updatedAt:Date.now()}),g(null),b("")}function z(e){"Enter"===e.key?(e.preventDefault(),U()):"Escape"===e.key&&(e.preventDefault(),g(null),b(""))}function W(){L(null)}function H(){C(null),L(null)}function V(e){if(!E||!I)return;let t=e.touches[0],s=Math.abs(t.clientX-I.x),n=Math.abs(t.clientY-I.y);if(s>10&&s>n){C(E);let e=document.elementFromPoint(t.clientX,t.clientY),s=null==e?void 0:e.closest("[data-notepad-id]");if(s){let e=s.getAttribute("data-notepad-id");e&&e!==E?L(e):L(null)}else L(null)}}function q(e){E&&S&&E!==S&&G(E,S),A(null),T(null),C(null),L(null)}async function G(e,t){try{await r(e,t)}catch(e){console.error("Error reordering notepads:",e),alert("Failed to reorder notepads")}}return(0,a.useEffect)(()=>{(async()=>{if(!s&&0===t.length&&!R){O(!0);let e=d([]);try{await j("notes",e.id,e,0),await l()}catch(e){console.error("Error creating initial notepad:",e)}finally{O(!1)}}})()},[s,t.length,R,l]),(0,a.useEffect)(()=>{if(!s&&t.length>0){let e=t.some(e=>e._key===i);i&&e||(h(!0),c(null))}},[t,i,c,h,s]),s?(0,n.jsx)("div",{className:"relative px-4 h-10",children:(0,n.jsx)("div",{className:"flex items-end overflow-x-auto scrollbar-hide h-10",children:(0,n.jsx)("div",{className:"px-3 h-8 rounded-md bg-slate-700 text-slate-400 text-sm flex items-center justify-center self-center",children:"Loading..."})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"relative px-4 h-10",children:[(0,n.jsxs)("div",{className:"flex items-end overflow-x-auto scrollbar-hide h-10",children:[(0,n.jsx)("button",{className:"px-3 h-8 rounded-md bg-slate-700 hover:bg-slate-600 text-slate-400 hover:text-slate-200 text-lg flex items-center justify-center self-center mr-1",onClick:F,disabled:R,title:"Add new notepad",children:"+"}),t.map(e=>(0,n.jsxs)("button",{"data-notepad-id":e._key,draggable:p!==e._key,onDragStart:t=>{var s;C(s=e._key),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",s)},onDragOver:t=>{var s;return s=e._key,void(t.preventDefault(),t.dataTransfer.dropEffect="move",L(s))},onDragLeave:W,onDrop:t=>{var s;return s=e._key,void(t.preventDefault(),k&&k!==s&&G(k,s),C(null),L(null))},onDragEnd:H,onTouchStart:t=>(function(e,t){if(p===t)return;let s=e.touches[0];A({x:s.clientX,y:s.clientY}),T(t)})(t,e._key),onTouchMove:V,onTouchEnd:q,className:"px-4 h-full rounded-t-md mr-1 transition-colors flex items-center ".concat(e._key===i&&!u?"bg-slate-800 text-slate-100":"bg-slate-700 text-slate-300 hover:bg-slate-600"," ").concat(k===e._key?"opacity-50":""," ").concat(S===e._key&&k!==e._key?"!bg-blue-600":""),onClick:()=>{c(e._key),h(!1)},title:p!==e._key?e._key===i?"Drag to reorder, double-click to rename":"Drag to reorder, click to select":"",children:[p===e._key?(0,n.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),onKeyDown:z,onBlur:U,className:"bg-transparent border-b border-slate-500 outline-none w-24 px-1",autoFocus:!0,onClick:e=>e.stopPropagation()}):(0,n.jsx)("span",{onDoubleClick:()=>{var t;(t=e._key)===i&&(g(t),b((null==m?void 0:m.name)||""))},className:"cursor-pointer hover:underline whitespace-nowrap",title:"Double-click to edit",children:e._key===i&&m?m.name:e.name}),t.length>1&&!p&&(0,n.jsx)("span",{className:"ml-2 text-slate-400 hover:text-slate-200",onClick:t=>{t.stopPropagation(),B(e._key),D(!0)},children:"\xd7"})]},e._key)),(0,n.jsx)("button",{className:"px-4 h-full rounded-t-md transition-colors flex items-center ".concat(u?"bg-slate-800 text-slate-100":"bg-slate-700 text-slate-300 hover:bg-slate-600"),onClick:()=>h(!0),title:"View help documentation",children:(0,n.jsx)("span",{className:"whitespace-nowrap",children:"?"})})]}),(0,n.jsx)("div",{className:"absolute top-0 right-4 w-8 h-10 bg-gradient-to-l from-slate-900 to-transparent pointer-events-none"})]}),(0,n.jsx)(N.A,{isOpen:M,onClose:function(){D(!1),B(null)},onConfirm:_,title:"Delete Notepad",message:'Are you sure you want to delete "'.concat(P?null==(e=t.find(e=>e._key===P))?void 0:e.name:"",'"?\n\nThis action cannot be undone.'),type:"confirm",confirmText:"Delete",cancelText:"Cancel"})]})}function S(e){let{notepadId:t}=e,{item:s,setItem:l,isLoading:r}=(0,w.H)("notes",t),{setHasFocus:i,setSelection:o,setDocumentStats:d}=c(),h=(0,a.useRef)(null),m=(0,a.useRef)(!1),x=()=>{if(!h.current)return;let e=h.current.innerText||"";if(u(h.current.innerHTML))return void d({chars:0,words:0});d({chars:e.length,words:e.trim()?e.trim().split(/\s+/).filter(Boolean).length:0})},p=()=>{h.current&&s&&(m.current=!0,l({...s,content:h.current.innerHTML,updatedAt:Date.now()}),m.current=!1,x())},g=()=>{let e=window.getSelection(),t=e?e.toString():"";if(e&&t.length>0)o({chars:t.replace(/\n/g,"").length,words:t.trim().split(/\s+/).filter(Boolean).length,isCurrentLine:!1});else if(e&&e.anchorNode){let t="";try{let s=e.anchorNode;s.nodeType===Node.TEXT_NODE?t=s.textContent||"":(t=s.innerText||"",s.innerHTML&&u(s.innerHTML)&&(t=""))}catch(e){t=""}o({chars:t.length,words:t.trim()?t.trim().split(/\s+/).filter(Boolean).length:0,isCurrentLine:!0})}else o({chars:0,words:0,isCurrentLine:!1})};return((0,a.useEffect)(()=>{if(s){if(h.current&&void 0!==s.content){let e=s.content||"";h.current.innerHTML!==e&&(h.current.innerHTML=e,x())}return document.addEventListener("selectionchange",g),()=>{document.removeEventListener("selectionchange",g)}}},[t,null==s?void 0:s.content]),r||!s)?(0,n.jsx)("div",{className:"h-full px-4 pb-0",children:(0,n.jsx)("div",{className:"h-full bg-slate-800 text-slate-100 relative rounded-md shadow-md",children:(0,n.jsx)("div",{className:"w-full h-full p-4 overflow-auto text-slate-400",children:r?"Loading...":"No notepad found"})})}):(0,n.jsx)("div",{className:"h-full px-4 pb-0",children:(0,n.jsx)("div",{className:"h-full bg-slate-800 text-slate-100 cursor-text relative rounded-md shadow-md",onClick:()=>{h.current&&h.current.focus()},children:(0,n.jsx)("div",{ref:h,className:"w-full h-full outline-none p-4 overflow-auto",style:{whiteSpace:"pre-wrap"},contentEditable:!0,onInput:p,onFocus:()=>{i(!0)},onBlur:()=>{i(!1)},onPaste:e=>{e.preventDefault();let t=e.clipboardData||window.clipboardData,s=t.getData("text/html");if(!s){if(s=t.getData("text/plain")){let e=window.getSelection();if(e.rangeCount>0){let t=e.getRangeAt(0);t.deleteContents();let n=s.split("\n"),l=document.createDocumentFragment();n.forEach((e,t)=>{e.trim()&&l.appendChild(document.createTextNode(e)),t<n.length-1&&l.appendChild(document.createElement("br"))}),t.insertNode(l),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}p()}return}let n=document.createElement("div");if(n.innerHTML=s,n.querySelectorAll("*").forEach(e=>{e.style&&(e.style.removeProperty("color"),e.style.removeProperty("background-color"),e.style.removeProperty("background"))}),h.current){let e=n.innerHTML,t=window.getSelection();if(t.rangeCount>0){let s=t.getRangeAt(0),n=document.createElement("span");n.id="paste-marker-temp",s.insertNode(n);let l=h.current.innerHTML.replace('<span id="paste-marker-temp"></span>',e);h.current.innerHTML=l;let a=window.getSelection(),r=document.createRange();r.selectNodeContents(h.current),r.collapse(!1),a.removeAllRanges(),a.addRange(r)}else h.current.innerHTML+=e}p()},onCopy:e=>{let t=window.getSelection();if(0===t.rangeCount)return;let s=t.getRangeAt(0).cloneContents(),n=document.createElement("div");n.appendChild(s),n.querySelectorAll("*").forEach(e=>{e.style&&(e.style.removeProperty("color"),e.style.removeProperty("background-color"),e.style.removeProperty("background"))}),e.clipboardData.setData("text/html",n.innerHTML),e.clipboardData.setData("text/plain",n.textContent||n.innerText),e.preventDefault()},suppressContentEditableWarning:!0})})})}function L(){let{activeNotepadId:e}=o();return e?(0,n.jsx)(S,{notepadId:e}):(0,n.jsx)("div",{className:"h-full px-4 pb-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-slate-400",children:"No notepad selected"})})}function I(){return(0,n.jsx)("div",{className:"h-full px-4 pb-0",children:(0,n.jsx)("div",{className:"h-full bg-slate-800 text-slate-100 relative rounded-md shadow-md",children:(0,n.jsxs)("div",{className:"w-full h-full p-4 overflow-auto",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Help & Documentation"}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-slate-700 rounded-lg border-l-4 border-yellow-500",children:[(0,n.jsx)("p",{className:"font-semibold mb-2",children:"⚠️ Important Limitations & Requirements"}),(0,n.jsxs)("p",{className:"mb-2",children:["This tooling is ",(0,n.jsx)("strong",{children:"UK only"}),"."]}),(0,n.jsxs)("p",{className:"mb-2",children:["You need eBay business policies configured—we can ",(0,n.jsx)("a",{href:"#business-policies",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"set these up"})," for you in Settings."]}),(0,n.jsx)("p",{children:"Personal accounts: Published listings require a quick edit/save on eBay's website (no changes needed) to enable Simple Delivery and mobile app editing."})]}),(0,n.jsx)("h2",{id:"quick-start",className:"text-xl font-bold mb-3 mt-6 px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 rounded-lg border-l-4 border-green-400",children:"Quick Start"}),(0,n.jsxs)("ol",{className:"list-decimal list-outside mb-6 ml-8 space-y-3",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Create Shipping Policies"})," - Go to ",(0,n.jsx)("a",{href:"?view=settings",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Settings"})," and create policy defaults (if you don't have them already)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Create a Draft"})," - Go to Drafts, Actions, New"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Add photos to your draft"})," - Take them using the built-in camera (recommended) or upload them directly if you've already taken them"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Add any relevant notes"})," - Note any defects that definitely need highlighting"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Run AI Assist"})," - Actions, AI Assist. It usually takes between 1 and 5 minutes"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Check the results"})," - Check the results for the tasks (item specifics, condition etc.) and make any adjustments if needed"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Publish!"})," - This should be close to instant, but if you've enabled promotions it can take up to 5 minutes as we have to wait for it to propagate on eBay's platform"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"(Optional) Re-enable Simple Delivery"})," - Click edit on your published listing and it'll take you straight to your listing on eBay. Simply saving without any adjustments at this point will re-enable Simple Delivery, but it's also a good opportunity to check everything is correct as this IS a closed beta"]})]}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-slate-700/50 rounded-lg",children:[(0,n.jsx)("p",{className:"font-semibold mb-3",children:"Table of Contents"}),(0,n.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#quick-start",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Quick Start"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#introduction",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Introduction"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#technical-features",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Technical Features"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#main-views",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"The 5 Main Views"})}),(0,n.jsx)("li",{className:"ml-4",children:(0,n.jsx)("a",{href:"#research",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"1. Research"})}),(0,n.jsx)("li",{className:"ml-4",children:(0,n.jsx)("a",{href:"#notes",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"2. Notes"})}),(0,n.jsx)("li",{className:"ml-4",children:(0,n.jsx)("a",{href:"#inventory",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"3. Inventory"})}),(0,n.jsx)("li",{className:"ml-4",children:(0,n.jsx)("a",{href:"#drafts",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"4. Drafts"})}),(0,n.jsx)("li",{className:"ml-4",children:(0,n.jsx)("a",{href:"#settings",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"5. Settings"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#business-policies",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Business Policies & Shipping"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#ai-assist",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"AI Assist"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"#my-workflow",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"My Workflow"})})]})]}),(0,n.jsx)("h2",{id:"introduction",className:"text-xl font-bold mb-3 mt-8 px-4 py-2 bg-slate-700 rounded-lg border-l-4 border-blue-500",children:"Introduction"}),(0,n.jsxs)("p",{className:"mb-4",children:["After years of selling on eBay and creating thousands of listings, I built this tool to work around the frustrations and ever-changing UI of the eBay platform. This is the tool that helps me run my business efficiently, and it's been refined through practical experience into a ",(0,n.jsx)("a",{href:"#my-workflow",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"workflow"}),' that prioritizes speed, efficiency, and reducing "not as described" returns.']}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"The premise is simple:"})," You provide good quality pictures and some rough notes about the item, and the highly customizable ",(0,n.jsx)("a",{href:"#ai-assist",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"AI Assist"})," feature does the heavy lifting—finding the right category, filling in all the item specifics, writing descriptions that match your voice, and suggesting appropriate pricing. Over time, as you refine AI Assist's settings to match how you work, it becomes an extension of yourself, producing listings that look like you wrote them, not an AI."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"No save buttons:"})," Everything is saved and synced in real-time as you work. You can have multiple windows or tabs open (for example, Notes in one window, Research in another) and all changes are instantly reflected everywhere."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Mobile and desktop as one:"})," We didn't cripple the mobile experience—every feature works identically across all devices. You could have a draft open on your desktop while simultaneously having it open on your phone to add photos and notes, and changes appear instantly on both."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Run in the browser or install to home screen:"}),' Use it directly in your browser, or on mobile, "Add to Home Screen" for an app-like experience with no address bar and full screen to work with.']}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Instant view switching:"})," Switching between views is immediate—no waiting, no loading spinners. Need to check your notes mid-draft? Jump to Notes, check what you need, and come straight back without losing your place. This applies to all views, making it effortless to move back and forth as you work."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Research without polluting your eBay history:"})," The research view doesn't use your eBay account, so it won't clutter your search history or cause eBay to start suggesting the very items you're trying to sell as things you might want to buy."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Integrated camera keeps your camera roll clean:"})," Use the built-in camera to take photos in the preferred 1:1 format and they go straight to the server—no cluttering up your phone's gallery with hundreds of listing photos."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Use what works for you:"})," This tool is opinionated by design, but every opinion comes from practical experience, not theory. You don't have to use everything. Many people use this only for inventory analysis and price research, then continue listing through eBay's own interface. That's perfectly fine—take what's useful and leave the rest."]}),(0,n.jsxs)("p",{className:"mb-6",children:[(0,n.jsx)("strong",{children:"Closed beta:"})," This tool is under active development as I improve it for my own use. Things could (but hopefully won't) break, though I will always do my best to ensure changes do not break existing data."]}),(0,n.jsx)("h2",{id:"main-views",className:"text-xl font-bold mb-3 mt-8 px-4 py-2 bg-slate-700 rounded-lg border-l-4 border-blue-500",children:"The 5 Main Views"}),(0,n.jsx)("h3",{id:"research",className:"text-lg font-semibold mb-2 mt-6 px-3 py-2 bg-slate-700/50 rounded border-l-4 border-cyan-500",children:"1. Research"}),(0,n.jsx)("p",{className:"mb-3",children:'The main goal is to find an appropriate price for selling your item, but it\'s also used "out and about" for deciding quickly if you want to buy something in the first place.'}),(0,n.jsx)("p",{className:"mb-3",children:"You search for the item and it performs 3 separate searches on eBay:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside mb-3 ml-4 space-y-1",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Lowest price:"})," Cheapest competition"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Highest sold price:"})," Maximum you'll realistically be able to sell for"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Recently sold:"})," Gives you an idea of the sell-through rate"]})]}),(0,n.jsx)("p",{className:"mb-3",children:"Through experience, I've found it's far easier to look at this data at a glance and work out pricing than using any automated tooling—especially when dealing with used, rare, or retro items that don't have a standardized current market value (like an iPhone)."}),(0,n.jsx)("p",{className:"mb-3",children:"On mobile, you can swipe left to right between columns. The history is handy as it fetches results back instantly so you can easily compare views. For example, you might search for your specific item to see how it performs, then do a broader search for the category or type to understand the wider competitive landscape and see what else buyers are looking at in that price range."}),(0,n.jsxs)("p",{className:"mb-3",children:["The data is exactly the same as using eBay itself, but due to the methods used, there are ",(0,n.jsx)("em",{children:"sometimes"})," mistakes (pretty rare). In that instance, you can click the title to open that search directly in eBay to look for yourself or tweak the parameters. You can also click on any of the listings to open them and look at other details."]}),(0,n.jsx)("p",{className:"mb-4",children:"A big benefit: it does not pollute your search history on your eBay account, so it won't suddenly start suggesting the very item you're trying to sell as something you might want to buy. It's also a lot faster."}),(0,n.jsx)("h3",{id:"notes",className:"text-lg font-semibold mb-2 mt-6 px-3 py-2 bg-slate-700/50 rounded border-l-4 border-cyan-500",children:"2. Notes"}),(0,n.jsx)("p",{className:"mb-3",children:"Yes, it might seem silly to reinvent another notes package—but having your eBay-specific notes all in one place, with the same powerful real-time sync used everywhere else in the app, makes a real difference. You can have as many tabs as you want, rename them by double-clicking on the title, and drag and drop to reorder."}),(0,n.jsx)("p",{className:"mb-3",children:"The word and character counts work on selections as you'd expect, but they also work on a per-line basis, which isn't common in most notes apps. This was designed specifically for experimenting with different listing titles—you can try out variations while keeping an eye on the character count to ensure they fit eBay's limits, without having to select anything."}),(0,n.jsx)("p",{className:"mb-4",children:"I tend to keep lists of items I need to sell as priority, snippets or reusable listing descriptions, and anything else related to my eBay workflow. Having it all scoped to this tool means it's always there when you need it, without cluttering up your general notes elsewhere."}),(0,n.jsx)("h3",{id:"inventory",className:"text-lg font-semibold mb-2 mt-6 px-3 py-2 bg-slate-700/50 rounded border-l-4 border-cyan-500",children:"3. Inventory"}),(0,n.jsx)("p",{className:"mb-3",children:"This page pulls all of your currently listed items down from eBay and presents the information in a highly digestible form. It's all stored directly in memory so search is immediate."}),(0,n.jsx)("p",{className:"mb-3",children:"One thing that always annoyed me about eBay's own search was the exact word matching—if you forgot whether you pluralized something, you won't find it. Search for \"GeForce\" and it won't bring up items titled \"GeForce4\" (without the space). This inventory view solves that frustration with flexible search that finds what you're actually looking for."}),(0,n.jsx)("p",{className:"mb-3",children:"As well as text search, you can refine your results by any number of item specifics and see at a glance how many of each kind you have. For example, selecting the Floppy Drives category lets me see exactly how many I have of each color instantly—no counting required."}),(0,n.jsx)("p",{className:"mb-4",children:'I find this very useful if someone asks "do you have any X?" or if I want to, at a glance, look at the distribution of my stock to focus my attention.'}),(0,n.jsx)("p",{className:"mb-4",children:(0,n.jsx)("em",{children:"Note: Although not available generally, this same code publishes my shop (spodesabode.com/shop) and there is a plan to make this available to all."})}),(0,n.jsx)("h3",{id:"drafts",className:"text-lg font-semibold mb-2 mt-6 px-3 py-2 bg-slate-700/50 rounded border-l-4 border-cyan-500",children:"4. Drafts"}),(0,n.jsx)("p",{className:"mb-3",children:"This is where you manage your drafts and subsequently publish them to eBay. The interface is significantly faster than eBay's listing tool—no more 5-10 second delays between changing options. Everything responds instantly."}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"Important:"})," Drafts in this system are completely separate from eBay's draft listings. eBay does not expose their draft system through the API, so there is no synchronization between the two. These are independent tools."]}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"Multi-select mode:"})," Select multiple drafts and run AI Assist across all of them in parallel. It takes the same amount of time to process 10 listings as it does to process 1—perfect for batch processing when you've photographed multiple items and want to get them all listed quickly."]}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"Once published, use eBay:"})," There's no point reinventing the wheel. This tool is designed for creating listings, but once they're published, eBay's own tools are excellent for managing active listings—bulk updates, promotional tools, and more. Use the right tool for each job."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Some features are missing:"})," Video uploads and scheduled listings aren't currently supported, and there may be other features I simply haven't needed to implement yet. If something's missing that you need, it's likely because I don't use it in my own workflow."]}),(0,n.jsx)("h3",{id:"settings",className:"text-lg font-semibold mb-2 mt-6 px-3 py-2 bg-slate-700/50 rounded border-l-4 border-cyan-500",children:"5. Settings"}),(0,n.jsxs)("p",{className:"mb-3",children:["This is where you refine AI Assist to match your style and set default values for your listings. You can also create a sensible set of default eBay business policies if you don't have them set up yet. See the ",(0,n.jsx)("a",{href:"#business-policies",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Business Policies & Shipping"})," section below for detailed information about setting up policies and the ",(0,n.jsx)("a",{href:"#ai-assist",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"AI Assist"})," section for how to customize it to write in your voice."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Multiple Accounts:"})," You can add and switch between multiple eBay accounts. Each account maintains its own drafts, settings, and inventory data."]}),(0,n.jsx)("h2",{id:"business-policies",className:"text-xl font-bold mb-3 mt-8 px-4 py-2 bg-slate-700 rounded-lg border-l-4 border-blue-500",children:"Business Policies & Shipping"}),(0,n.jsx)("p",{className:"mb-3",children:"This app uses the API to publish listings, and eBay requires you to be enrolled in business policies with basic returns, payment, and shipping policies configured. Without these, the API will not allow you to create listings."}),(0,n.jsx)("p",{className:"mb-3",children:"It sounds complex, but business policies are simply pre-defined defaults for things like return policies, shipping costs for various item sizes, and payment options. Once set up, you can reuse them across all your listings without having to configure these details every time."}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"Don't worry:"})," Despite the name, business policies have always been supported by personal accounts and do not change your account into a business account. There's nothing to worry about—it's just eBay's terminology."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"We can configure these for you:"})," Head to the ",(0,n.jsx)("a",{href:"?view=settings",className:"text-blue-400 hover:text-blue-300 hover:underline",children:"Settings view"})," where you'll find an option to automatically create a sensible set of default policies. These defaults are Royal Mail only and include:"]}),(0,n.jsxs)("ul",{className:"list-disc list-inside mb-4 ml-4 space-y-1",children:[(0,n.jsx)("li",{children:"Various weight categories with prices padded to cover packaging costs"}),(0,n.jsx)("li",{children:"2-day dispatch timeframe"}),(0,n.jsx)("li",{children:"Global Shipping Program (GSP) variants"}),(0,n.jsx)("li",{children:"Returns allowed and returns not allowed options"}),(0,n.jsx)("li",{children:"Standard managed payment and immediate payment policies"})]}),(0,n.jsx)("p",{className:"mb-4",children:"Once created, these policies can easily be edited in eBay's Business Policies section to add additional shipping services, adjust prices, or modify any other settings to suit your specific needs."}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2 mt-6",children:"UK Simple Delivery Quirks (Personal Accounts)"}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"Note:"})," This section only applies to personal eBay accounts."]}),(0,n.jsx)("p",{className:"mb-3",children:"In the UK, eBay's \"Simple Delivery\" system is currently mandatory for many categories on personal accounts. However, there's no way to control Simple Delivery through the API, which creates some quirks you should be aware of:"}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"When publishing:"})," Because we publish using business policies (the only method available via API), this has the side-effect of initially disabling Simple Delivery on your listing. Some sellers may actually prefer this, as it gives more control over shipping options."]}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"When editing in eBay:"})," If you edit a published listing directly in eBay's interface after it's been published through this app, eBay will automatically upgrade the listing to use Simple Delivery. This is eBay's standard behavior and happens consistently."]}),(0,n.jsxs)("p",{className:"mb-3",children:[(0,n.jsx)("strong",{children:"Bulk editing behavior:"})," Bulk editing listings in eBay likely triggers the same Simple Delivery upgrade, though this hasn't been extensively tested yet."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Why weight and size matter:"})," Because of these quirks, it's important to always select accurate weight and package size parameters when creating listings. If eBay does automatically upgrade your listing to Simple Delivery (either immediately or later), it will use these values to determine the correct shipping category and pricing. Accurate dimensions ensure your shipping costs are calculated correctly regardless of which system eBay uses."]}),(0,n.jsx)("h2",{id:"ai-assist",className:"text-xl font-bold mb-3 mt-8 px-4 py-2 bg-slate-700 rounded-lg border-l-4 border-blue-500",children:"AI Assist"}),(0,n.jsx)("p",{className:"mb-4",children:"All you need to provide is good quality photos and some rough notes about the item—AI Assist does the rest. It analyzes your photos to automatically suggest the best category, populate item-specific attributes, write the description, and suggest pricing. It can be run on individual drafts or in bulk across multiple items, making it perfect for batch processing."}),(0,n.jsx)("p",{className:"mb-4",children:"Unlike eBay's built-in AI (which seems to focus on producing lots of unnecessary marketing content), AI Assist is designed to fill in all the item specifics accurately and create copy that reduces \"not as described\" returns. It's a practical tool focused on the details that actually matter."}),(0,n.jsx)("p",{className:"mb-4",children:"The goal is simple: create listings that look like you wrote them, not an AI. This is achieved through configurability. Through the Settings panel, you can progressively teach AI Assist to write listings exactly as you would. As you use it, you'll notice patterns—recurring mistakes, missing context, or categories that need special handling. Instead of fighting these patterns every time, you address them once in the settings, and AI Assist learns."}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Listing Style"}),' controls how AI Assist writes titles, descriptions, and condition descriptions. You can select from presets like "Minimal & Factual" (my preference) or create your own style guide entirely. This is where you define your voice—whether you prefer technical specifications, casual tone, or something in between.']}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Pricing Strategy"})," lets you control how prices are suggested—whether you prioritize quick sales, market matching, or premium pricing. This ensures the AI's pricing recommendations align with your business approach."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"General Instructions"})," are universal requirements that apply to all your listings. Think of these as your standard operating procedure—closing phrases, disclaimers, or anything you consistently include. Build this up over time as you notice what AI Assist needs reminding about, and eventually these become automatic."]}),(0,n.jsxs)("p",{className:"mb-4",children:[(0,n.jsx)("strong",{children:"Category Instructions"})," are where AI Assist becomes truly powerful. Add specific instructions for different categories to handle their unique requirements. For example, I always replace CMOS batteries on motherboards, so I've added \"All motherboards have been fitted with new CMOS batteries\" as a category instruction—now I don't need to mention it in notes every time. This is also perfect for correcting recurring category-specific mistakes. Over time, you'll build up a knowledge base that captures how you handle each type of item."]}),(0,n.jsx)("p",{className:"mb-4",children:"For item-specific requirements that don't fit into your general patterns, just add instructions directly in the draft notes. This gives you precise control when needed without cluttering your global settings."}),(0,n.jsx)("p",{className:"mb-6",children:"This layered approach—global settings, category-specific instructions, and per-item notes—means AI Assist becomes an extension of yourself rather than a generic tool. The more you refine these settings, the more it writes exactly as you would. Eventually, you'll find it consistently produces listings that match your style so closely, you'd struggle to tell the difference."}),(0,n.jsx)("h2",{id:"my-workflow",className:"text-xl font-bold mb-3 mt-8 px-4 py-2 bg-slate-700 rounded-lg border-l-4 border-blue-500",children:"My Workflow"}),(0,n.jsx)("p",{className:"mb-4",children:"Everything starts life as a draft. I add a rough photo for identification, then test the item and add screenshots of tests carried out. I only make notes for things that aren't already covered by my general approach—repair work carried out, or specific damage that definitely needs highlighting. The AI will handle turning these rough notes into proper listing copy."}),(0,n.jsx)("p",{className:"mb-4",children:"I work in batches. If I'm listing graphics cards, I'll do this for ten cards and put them to one side. When I'm ready, I go to my photo area, open the draft for each item, delete the rough photo, replace it with studio photos, and rearrange them by order of importance."}),(0,n.jsxs)("p",{className:"mb-4",children:["Once I've taken photos for the entire batch, I run AI Assist in parallel on all of them. ",(0,n.jsx)("strong",{children:"If the AI can't find everything it needs from the photos, then neither will your buyer"}),"—so it's a good way of knowing I didn't take enough pictures or provide enough details. For example, with a hard drive, a good close-up photo of the label provides everything—capacity, interface type, model number—both for the buyer to verify and for the AI to extract all the item specifics automatically."]}),(0,n.jsx)("p",{className:"mb-4",children:"I generally prefer to price things myself. Due to the retro and refurbished nature of the items I sell, pricing is a lot more complex than standard products—comparable prices are only one aspect of it. I also tend to pad my prices to allow for offers, since most people are going to send me an offer regardless of what price I put it at. I then double-check what the AI has done, tweak if necessary, and publish."}),(0,n.jsx)("p",{className:"mb-4",children:'I use "Minimal & Factual" as my preferred listing style because although lots of extra detail can seem like a good idea, it often just provides words that can be twisted into a "not as described" return to disguise buyer\'s remorse. Keep it factual, keep it minimal, let the photos do the talking.'}),(0,n.jsx)("div",{className:"mt-8 pt-6 border-t border-slate-600 text-sm text-slate-400",children:(0,n.jsx)("p",{children:"This documentation is updated regularly. Check back for new features and improvements."})})]})})})}function A(){let{activeNotepadId:e,showHelp:t}=o();return(0,n.jsxs)("div",{className:"h-full overflow-auto custom-scrollbar flex flex-col",children:[(0,n.jsx)(C,{}),(0,n.jsx)("div",{className:"flex-1 min-h-0",children:t?(0,n.jsx)(I,{}):e&&(0,n.jsx)(L,{})})]})}var E=s(1691);function T(){let{activeSearch:e,triggerSearch:t,setActiveSearch:s,setTriggerSearch:l}=(0,E.O)(),{results:i,setResults:o}=(0,E.v)(),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)([]),m=(0,a.useRef)(!1);function x(e,t){h(s=>[...s,{query:e,category:t}])}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;e.trim()&&(s(e),o(t=>{let s={...t,[e]:{cheapest:{status:"pending"},highest:{status:"pending"},recent:{status:"pending"}}},n=Object.keys(s);return n.length>10&&n.slice(0,n.length-10).forEach(e=>{delete s[e]}),s}),x(e,"cheapest"),x(e,"highest"),x(e,"recent"))}return(0,a.useEffect)(()=>{if(i&&Object.keys(i).length>0){let t=Object.keys(i),n=t[t.length-1];e&&i[e]||s(n)}},[i,e,s]),(0,a.useEffect)(()=>{e&&d(e)},[e]),(0,a.useEffect)(()=>{t&&t.trim()&&(d(t),l(""))},[t,l]),(0,a.useEffect)(()=>{m.current||0===u.length||(m.current=!0,(async()=>{let[e,...t]=u,{query:s,category:n}=e;o(e=>({...e,[s]:{...e[s],[n]:{status:"loading"}}}));try{let e=(0,r._9)().access_token,t=await fetch("/api/research?q=".concat(encodeURIComponent(s),"&category=").concat(n,"&limit=60"),{headers:{Authorization:"Bearer ".concat(e)}}),l=await t.json();t.ok?o(e=>({...e,[s]:{...e[s],[n]:{status:"done",...l}}})):o(e=>({...e,[s]:{...e[s],[n]:{status:"error",url:l.url}}}))}catch(e){console.error("Failed to fetch ".concat(n,' for "').concat(s,'":'),e),o(e=>({...e,[s]:{...e[s],[n]:{status:"error"}}}))}await new Promise(e=>setTimeout(e,1e3+Math.floor(500*Math.random()))),h(t),m.current=!1})())},[u,i,o]),(0,n.jsxs)("div",{className:"flex items-center sm:gap-2 flex-wrap sm:flex-nowrap",children:[(0,n.jsx)("div",{className:"w-full sm:w-auto mb-2 sm:mb-0 sm:mr-4",children:(0,n.jsx)(p,{})}),(0,n.jsxs)("div",{className:"w-full flex flex-wrap sm:flex-nowrap gap-2",children:[(0,n.jsxs)("div",{className:"input-container flex-1 h-10 w-full relative",children:[(0,n.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),g())},placeholder:"Search eBay...",className:"w-full bg-transparent border-0 outline-none pr-4 text-slate-100"}),c&&(0,n.jsx)("button",{onClick:function(){d("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-200 transition-colors",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,n.jsx)("div",{className:"flex gap-2 ml-auto",children:(0,n.jsx)("button",{className:"btn btn-accent h-10 px-3 py-0 shrink-0 flex items-center gap-1",onClick:()=>g(),children:i[c.trim()]?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Refresh"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("path",{d:"m21 21-4.35-4.35"})]}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Search"})]})})})]})]})}function M(){let{activeSearch:e,setActiveSearch:t}=(0,E.O)(),{results:s,setResults:l}=(0,E.v)(),[r,i]=(0,a.useState)(!1);return 0===Object.keys(s).length?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"relative px-4 pb-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",children:[(0,n.jsx)("button",{onClick:function(){i(!0)},className:"px-2 py-2 rounded-md bg-slate-800 hover:bg-slate-700 text-slate-400 hover:text-slate-200 flex-shrink-0",title:"Clear all history",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M3 6h18"}),(0,n.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,n.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})}),Object.keys(s).slice(-10).reverse().map((a,r)=>(0,n.jsxs)("div",{className:"px-3 py-1.5 rounded-md cursor-pointer flex-shrink-0 flex items-center gap-2 ".concat(a===e?"bg-green-600 text-white":"bg-slate-800 hover:bg-slate-700 text-slate-100"),children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"flex-shrink-0",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("path",{d:"m21 21-4.35-4.35"})]}),(0,n.jsx)("span",{onClick:()=>{t(a)},className:"flex-grow",children:(0,n.jsx)("span",{title:a,children:a.length>30?"".concat(a.slice(0,29).trim(),"…"):a})}),(0,n.jsx)("span",{className:"ml-2 ".concat(a===e?"text-white/80 hover:text-white":"text-slate-400 hover:text-slate-200"),onClick:e=>{e.stopPropagation();let t={...s};delete t[a],l(t)},children:"\xd7"})]},r))]}),(0,n.jsx)("div",{className:"absolute top-0 right-4 w-8 h-full bg-gradient-to-l from-slate-900 to-transparent pointer-events-none"})]}),(0,n.jsx)(N.A,{isOpen:r,onClose:function(){i(!1)},onConfirm:function(){l({}),t("")},title:"Clear Search History",message:"Are you sure you want to clear all search history?\\n\\nThis action cannot be undone.",type:"confirm",confirmText:"Clear All",cancelText:"Cancel"})]})}function D(e){return e.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}function P(e){let{title:t,condition:s,link:l,image:a,price:r,shipping:i,total:o,sold:c,soldDateString:d,bestOffer:u}=e;return(0,n.jsxs)("div",{className:"flex items-start gap-4 p-3 bg-slate-900/40 rounded-md hover:bg-slate-900/70 transition-colors",children:[(0,n.jsx)("div",{className:"w-32 h-32 flex-shrink-0 overflow-hidden relative rounded-md",children:(0,n.jsx)("img",{className:"absolute w-full h-full object-cover",src:a,alt:t})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0 space-y-2",children:[(0,n.jsx)("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"group hover:text-green-400 transition-colors",children:(0,n.jsxs)("h3",{className:"font-medium break-words inline-block",children:[t,(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline-block ml-1 -mt-0.5 opacity-70 group-hover:opacity-100",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})}),(0,n.jsx)("div",{className:"Parts only"===s?"text-red-400 text-sm":"text-blue-300 text-sm",children:s}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:c?u?"text-green-500 line-through":"text-green-500 font-medium":"text-blue-400 font-medium",children:["\xa3",D(o)]}),(0,n.jsxs)("div",{className:"text-slate-400 text-sm italic",children:["\xa3",D(r)," + \xa3",D(i)," p&p"]}),c&&d&&(0,n.jsx)("div",{className:"text-slate-400 text-xs mt-1",children:d})]})]})]})}let B={cheapest:"Cheapest Competition",highest:"Highest Sold",recent:"Recently Sold"};function R(e){let{category:t,data:s}=e;s&&"object"==typeof s&&s.status||(s={status:"error"});let l=B[t],a="pending"===s.status||"loading"===s.status,r="error"===s.status,i="done"===s.status&&s.items&&s.items.length>0,o="done"===s.status&&s.items&&0===s.items.length;return(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsx)("div",{className:"mb-4",children:s.url?(0,n.jsxs)("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xl font-medium text-slate-100 hover:text-green-400 transition-colors",children:[(0,n.jsx)("h2",{children:l}),(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}):(0,n.jsx)("h2",{className:"text-xl font-medium text-slate-100",children:l})}),a&&(0,n.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-400",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-slate-400 border-t-transparent rounded-full"}),(0,n.jsx)("p",{children:"Loading..."})]})}),r&&(0,n.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-400",children:(0,n.jsx)("p",{children:"Error fetching results."})}),o&&(0,n.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-400",children:(0,n.jsx)("p",{children:"No results found"})}),i&&(0,n.jsx)("div",{className:"space-y-4",children:s.items.map((e,t)=>(0,n.jsx)(P,{...e},t))})]})}function O(){let{activeSearch:e}=(0,E.O)(),{results:t}=(0,E.v)();if(!e||!t[e])return null;let s=t[e],l=[{key:"cheapest",data:s.cheapest},{key:"highest",data:s.highest},{key:"recent",data:s.recent}];return(0,n.jsx)("div",{className:"min-h-full flex overflow-x-auto sm:overflow-x-visible gap-4 mx-4 sm:ml-4 sm:mr-2 pb-0 sm:flex-nowrap scroll-snap-x scroll-smooth",children:l.map(e=>{let{key:t,data:s}=e;return(0,n.jsx)("div",{className:"min-w-full sm:min-w-0 flex-1 bg-slate-800 p-4 rounded-md shadow-md scroll-snap-start",children:(0,n.jsx)(R,{category:t,data:s})},t)})})}function F(){return(0,n.jsxs)("div",{className:"h-full overflow-y-auto overflow-x-hidden sm:overflow-y-scroll custom-scrollbar flex flex-col",children:[(0,n.jsx)(M,{}),(0,n.jsx)("div",{className:"flex-1 min-h-0",children:(0,n.jsx)(O,{})})]})}let _=(0,i.F)({syncData:{lastSynced:null,rawListings:{}}},{store:!0,compress:!0,namespace:"inventory"}),U=(0,i.F)({syncing:!1,loadingItemIds:[],isPublishing:!1,inventoryData:null,productAttributes:null,selectedProductType:null,selectedFilters:{},selectedAttribute:null,filteredItems:[],showRareAttributes:!1,searchText:"",searchDisplayText:"",currentPanel:0});async function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"eBay API call failed",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={};s&&(n.headers={Authorization:"Bearer ".concat(s)});let l=await fetch(e,n),a=await l.json();if(!l.ok||!0!==a.success)throw Error(a.error||t);return a}async function W(e,t){var s,n;let l=await z("/api/ebay/item?itemId=".concat(e),"Failed to fetch item details",t);if(!l.data||!l.data.Item)throw Error("Invalid API response for item ".concat(e," - missing Item data"));let a=l.data.Item;if(!a.Title)throw Error("Invalid API response for item ".concat(e," - missing Title"));if(!(null==(n=a.SellingStatus)||null==(s=n.CurrentPrice)?void 0:s.value))throw Error("Invalid API response for item ".concat(e," - missing Price"));let r={id:e,title:a.Title,price:a.SellingStatus.CurrentPrice.value,quantity:a.Quantity||0,pictureURL:null,fetchedAt:new Date().toISOString(),rawData:function(e){var t,s;if(!e||!e.Item)return{};let n=e.Item;return{Item:{ItemID:n.ItemID,Title:n.Title,Description:n.Description,SellingStatus:n.SellingStatus,Quantity:n.Quantity,PrimaryCategory:n.PrimaryCategory,PictureDetails:n.PictureDetails,PictureURL:n.PictureURL,ItemSpecifics:n.ItemSpecifics,ListingDetails:{StartTime:null==(t=n.ListingDetails)?void 0:t.StartTime,EndTime:null==(s=n.ListingDetails)?void 0:s.EndTime}}}}(l.data)};return a.PictureDetails&&(r.pictureURL=a.PictureDetails.PhotoDisplay||a.PictureDetails.GalleryURL||(Array.isArray(a.PictureDetails.PictureURL)?a.PictureDetails.PictureURL[0]:a.PictureDetails.PictureURL)),!r.pictureURL&&a.PictureURL&&(r.pictureURL=Array.isArray(a.PictureURL)?a.PictureURL[0]:a.PictureURL),r}function H(){let{syncing:e,loadingItemIds:t,isPublishing:s,setSyncing:l,setLoadingItemIds:i,setIsPublishing:o,setInventoryData:c}=U(),{syncData:d,setSyncData:u}=_(),{setItem:h}=(0,w.H)("inventory","data"),m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0){let t=e.join("\n");alert("".concat(e.length," item").concat(e.length>1?"s":""," failed to fetch:\n").concat(t))}try{let e=(0,r._9)(),t=await fetch("/api/ebay/analytics",{headers:{Authorization:"Bearer ".concat(e.access_token)}}),s=await t.json();if(t.ok&&Object.keys(s).length>0){let e=Object.entries(s).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(s)}).join("\n");alert("API rate limits are active. Reset times:\n\n".concat(e))}}catch(e){console.error("Failed to check analytics:",e)}},x=async()=>{l(!0);try{let e=(0,r._9)(),{rawListings:t,lastSynced:s}=d,n=[];if(s){let t=new Date(s).toISOString(),l=await z("/api/ebay/events?from=".concat(t),"Failed to fetch events",e.access_token);l.itemIds&&(n=l.itemIds,console.log("Items with events since last sync:",n))}let l=await z("/api/ebay/items","Failed to fetch item IDs",e.access_token),a=l.itemIds&&Array.isArray(l.itemIds)?l.itemIds:[],i=[];for(let e of n)a.includes(e)&&i.push(e);for(let e of a)t[e]||i.push(e);let o=[...new Set(i)],c=await g(o),m={};a.forEach(e=>{t[e]&&(m[e]=t[e])}),Object.assign(m,c);let x={lastSynced:Date.now(),rawListings:m};u(x),h(x),console.log("Cache updated: ".concat(Object.keys(t).length," -> ").concat(Object.keys(m).length," (removed obsolete, added ").concat(Object.keys(c).length," new)"))}catch(e){console.error("Error fetching inventory:",e),await m()}finally{l(!1)}},g=async e=>{if(0===e.length)return{};let t=(0,r._9)();i(e);let s=[...e],n=0,l=0,a=[],o={},c=async()=>{for(;s.length>0&&0===a.length;){let e=s.pop();n++;try{let s=await W(e,t.access_token);s&&(o[e]=s)}catch(t){console.error("Error fetching details for item ".concat(e,":"),t),a.push(t.message)}finally{n--,l++,i([...s])}}},d=[];for(let t=0;t<Math.min(5,e.length);t++)d.push(c());if(await Promise.all(d),a.length>0)throw await m(a),Error("Sync aborted after failures to prevent API blocking");return o},f=async()=>{o(!0);try{let e=(0,r.vv)(),{rawListings:t}=d,s=Object.values(t),n=await fetch("/api/deployment/github-pages",{method:"POST",headers:{"Content-Type":"application/json","x-github-token":e},body:JSON.stringify(s)}),l=await n.json();if(n.ok)alert("Shop published successfully!");else throw Error(l.message||"Failed to publish shop")}catch(e){console.error("Error publishing shop:",e),alert("Error: ".concat(e.message))}finally{o(!1)}};return(0,a.useEffect)(()=>{let{rawListings:e}=d,t=Object.values(e);t.length>0?c(function(e){let t={items:{},attributes:{},categoryOptions:[],categoryGroups:{},itemsByCategory:{}};return e.forEach(e=>{if(!e||!e.id)return;let s=function(e){var t,s,n;let l={};if(null==(n=e.rawData)||null==(s=n.Item)||null==(t=s.ItemSpecifics)?void 0:t.NameValueList){let t=e.rawData.Item.ItemSpecifics.NameValueList;Array.isArray(t)&&t.forEach(e=>{e.Name&&e.Value&&(l[e.Name]=e.Value)})}return l}(e),n=function(e){var t,s,n;if(null==(n=e.rawData)||null==(s=n.Item)||null==(t=s.PrimaryCategory)?void 0:t.CategoryName){let t=e.rawData.Item.PrimaryCategory.CategoryName,s=t.split(":").map(e=>e.trim()),n=s[s.length-1],l=s.length>1?s[s.length-2]:null;return{main:s[0]||"Uncategorized",sub:s[1]||null,parent:l,leaf:n||null,full:t,parts:s}}return{main:"Uncategorized",sub:null,parent:null,leaf:null,full:"Uncategorized",parts:["Uncategorized"]}}(e),l=[e.title||"",n.leaf||"",n.parent||"",n.main||""];Object.values(s).forEach(e=>{Array.isArray(e)?l.push(...e.map(e=>e.toString())):l.push(e.toString())});let a=l.join(" ").toLowerCase();if(!e.rawData||!e.rawData.Item)throw console.error("[DEBUG] Malformed listing - missing rawData.Item for ID:",e.id),console.error("[DEBUG] Full listing object:",JSON.stringify(e,null,2)),Error("Malformed listing data for item ".concat(e.id," - missing rawData.Item"));let r=e.rawData.Item;if(!r.Description)throw console.error("[DEBUG] Missing Description for item ID:",e.id),console.error("[DEBUG] Full itemData structure:",JSON.stringify(r,null,2)),console.error("[DEBUG] Full listing object:",JSON.stringify(e,null,2)),Error("Missing Description for item ".concat(e.id));t.items[e.id]={id:e.id,title:e.title,price:e.price,description:e.rawData.Item.Description,pictureURLs:Array.isArray(e.rawData.Item.PictureDetails.PictureURL)?e.rawData.Item.PictureDetails.PictureURL:[e.rawData.Item.PictureDetails.PictureURL],specifics:s,searchText:a};let i=n.leaf||n.sub||n.main,o=n.parent||n.main;n.main,t.items[e.id].categoryInfo=n;let c="".concat(o,":").concat(i);t.items[e.id].categoryKey=c,t.categoryGroups[o]||(t.categoryGroups[o]={count:0,types:{}}),t.categoryGroups[o].types[i]||(t.categoryGroups[o].types[i]={name:i,count:0,itemIds:[]}),t.categoryGroups[o].count++,t.categoryGroups[o].types[i].count++,t.categoryGroups[o].types[i].itemIds.push(e.id),t.itemsByCategory[c]||(t.itemsByCategory[c]=[]),t.itemsByCategory[c].push(e.id),Object.entries(s).forEach(s=>{let[n,l]=s;if(!l)return;let a=n.trim();(Array.isArray(l)?l:[l]).forEach(s=>{s=s.toString().trim(),t.attributes[a]||(t.attributes[a]={name:a,values:{}}),t.attributes[a].values[s]||(t.attributes[a].values[s]={name:s,itemIds:[]}),t.attributes[a].values[s].itemIds.push(e.id)})})}),Object.entries(t.categoryGroups).sort((e,t)=>t[1].count-e[1].count).forEach(e=>{let[s,n]=e;t.categoryOptions.push({value:"",label:s,count:n.count,isGroup:!0}),Object.values(n.types).sort((e,t)=>e.name.localeCompare(t.name)).forEach(e=>{let n="".concat(s,":").concat(e.name);t.categoryOptions.push({value:n,label:e.name,count:e.count,indent:1,parent:s})})}),t}(t)):c(null)},[d]),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,n.jsx)("div",{className:"w-full sm:w-auto sm:mr-4",children:(0,n.jsx)(p,{})}),(0,n.jsxs)("div",{className:"w-full sm:w-auto sm:flex-1 flex sm:justify-end items-center gap-2 sm:gap-3",children:[(0,n.jsxs)("button",{onClick:x,disabled:e,className:"btn btn-accent h-10 px-3 py-0 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1 flex-1 sm:flex-none",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),(0,n.jsx)("path",{d:"M21 3v5h-5"}),(0,n.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),(0,n.jsx)("path",{d:"M3 21v-5h5"})]}),e?t.length>0?"Syncing\xa0(".concat(t.length,")"):"Syncing...":"Sync"]}),(0,r.vv)()&&(0,n.jsxs)("button",{onClick:f,disabled:0===Object.keys(d.rawListings).length||s,className:"h-10 px-3 py-0 bg-blue-600 hover:bg-blue-700 border-blue-700 hover:border-blue-600 text-white rounded shadow transition-colors border disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1 flex-1 sm:flex-none",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),(0,n.jsx)("polyline",{points:"14,2 14,8 20,8"}),(0,n.jsx)("path",{d:"M12 18v-6"}),(0,n.jsx)("path",{d:"m9 15 3 3 3-3"})]}),s?"Publishing...":"Publish"]})]})]})}var V=s(9949);function q(){var e;let{inventoryData:t}=U(),{setSyncData:s}=_(),{item:l}=(0,w.H)("inventory","data"),{item:r}=(0,w.H)("settings","user-preferences"),i=(null==r||null==(e=r.defaults)?void 0:e.accountType)||"INDIVIDUAL";return(0,a.useEffect)(()=>{l&&s(l)},[l,s]),(0,n.jsx)("div",{className:"px-4 pb-0 h-full flex flex-col",children:(0,n.jsx)(V.A,{items:t,isShopMode:!1,accountType:i})})}function G(e){let{options:t=[],value:s,onChange:l,isMulti:r=!1,allowCustom:i=!1,placeholder:o="Search or select...",visibleLimit:c=20,searchable:d="auto",searchThreshold:u=10}=e,[h,m]=(0,a.useState)(""),[x,p]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[b,y]=(0,a.useState)(c),[w,j]=(0,a.useState)("bottom"),v=(0,a.useRef)(null),k=i||("auto"===d?t.length>u:d),N=r&&Array.isArray(s)?s:s?[s]:[],C=i?N.filter(e=>!t.find(t=>t.label===e)):[],S=k&&h.length>0?t.filter(e=>e.label.toLowerCase().includes(h.toLowerCase())):t,L=[...C.map(e=>({id:e,label:e,isCustom:!0})),...S].slice(0,b+C.length),I=()=>{if(!v.current)return;let e=v.current.getBoundingClientRect(),t=window.innerHeight-e.bottom,s=e.top;t<256&&s>t?j("top"):j("bottom")};(0,a.useEffect)(()=>{let e=e=>{v.current&&!v.current.contains(e.target)&&(p(!1),f(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let A=r?Array.isArray(s)?s:s?[s]:[]:s,E=r?A&&A.length>0?A.join(", "):"":A||"",T=g?h:E,M=r?A&&A.length>0:!!A;return(0,n.jsxs)("div",{ref:v,className:"relative",children:[(0,n.jsxs)("div",{className:"relative",children:[k?(0,n.jsx)("input",{type:"text",value:T,onChange:e=>{m(e.target.value),f(!0),x||(I(),p(!0))},onFocus:()=>{m(""),f(!0),I(),p(!0)},onKeyDown:e=>{if("Enter"===e.key&&h.trim()&&i){e.preventDefault();let t=h.trim();if(r){let e=Array.isArray(s)?s:s?[s]:[];e.includes(t)||l([...e,t]),m("")}else l(t),m(""),p(!1),f(!1)}else"Escape"===e.key&&(m(""),p(!1),f(!1),e.target.blur())},placeholder:o,className:"w-full bg-slate-700 text-slate-100 text-base border border-slate-600 rounded-lg px-4 py-2 pr-10 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}):(0,n.jsx)("div",{onClick:()=>{I(),p(!x)},onKeyDown:e=>{"Escape"===e.key&&x&&p(!1)},tabIndex:0,className:"w-full bg-slate-700 text-slate-100 text-base border border-slate-600 rounded-lg px-4 py-2 pr-10 cursor-pointer focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",children:E?(0,n.jsx)("span",{children:E}):(0,n.jsx)("span",{className:"text-slate-500",children:o})}),M&&!g&&(0,n.jsx)("button",{onClick:()=>{l(r?[]:null),m("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-200",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),x&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 z-10",onClick:()=>{p(!1),f(!1)}}),x&&(0,n.jsxs)("div",{className:"absolute z-20 w-full bg-slate-800 border border-slate-600 rounded-lg max-h-64 overflow-auto custom-scrollbar ".concat("top"===w?"bottom-full mb-1":"mt-1"),style:{boxShadow:"0 4px 20px rgba(241, 245, 249, 0.15)"},onScroll:e=>{e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight&&b<S.length&&y(e=>Math.min(e+20,S.length))},children:[0===L.length&&k&&h.length>0&&(0,n.jsx)("div",{className:"px-4 py-3 text-slate-400 text-sm",children:i?'Press Enter to add "'.concat(h,'"'):"No matches found"}),L.map((e,t)=>{let a=r?(s||[]).includes(e.label):s===e.label;return(0,n.jsx)("button",{onClick:()=>(e=>{if(r){let t=Array.isArray(s)?s:s?[s]:[];t.includes(e.label)?l(t.filter(t=>t!==e.label)):l([...t,e.label])}else l(e.label),p(!1),f(!1),m("")})(e),className:"w-full px-4 py-2 text-left text-base hover:bg-slate-700 transition-colors border-b border-slate-700 last:border-b-0 ".concat(a?"bg-slate-700":""),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,n.jsx)("span",{className:"text-slate-100 truncate",children:e.label}),e.isCustom&&(0,n.jsx)("span",{className:"text-xs text-slate-400 shrink-0",children:"(custom)"})]}),a&&(0,n.jsx)("span",{className:"text-blue-400 shrink-0",children:"✓"})]})},"".concat(e.id,"-").concat(t))}),b<S.length&&(0,n.jsxs)("div",{className:"px-4 py-2 text-slate-400 text-xs text-center",children:["Showing ",b," of ",S.length," - scroll for more"]})]})]})}let Y={listingStyle:[{id:"minimal-factual",label:"Minimal & Factual",instructions:'Minimal and factual listings, aimed at reducing "not as described" returns. If item specifics, photos, and screenshots are comprehensive, there should be almost nothing left to say in the descriptions.\n\nCondition description and main description should contain the same content (repeated because eBay\'s UI often truncates the condition description). However, respect the formatting requirements of each field.\n\nContent: Start with "Tested and working." if functional. Then add ONLY information explicitly mentioned in seller notes: repairs/work done (e.g., "New CMOS battery", "Fresh thermal paste") and specific issues/defects (e.g., "Missing retention bracket", "Cracked corner"). Do NOT describe cosmetic condition from photos - ignore photos entirely for condition description.\n\nDo NOT mention the absence of things (e.g., "no repairs done", "no modifications").\n\nClose with: "See photos for details." or "See photos and screenshots for details." if diagnostic screenshots are present.\n\nTarget length: 1-3 sentences maximum. Often just "Tested and working. See photos for details." is sufficient.'},{id:"balanced",label:"Balanced",instructions:"Balanced listings that prioritize accuracy and efficiency.\n\nCondition Description: Concise facts from seller notes only - work done, issues/defects highlighted by seller. Do not elaborate or add qualifiers not provided by seller.\n\nDescription: Start by repeating the condition description content. Then add only supplementary information with genuine value not already covered elsewhere - examples include OEM/manufacturer part numbers (searchable), BIOS version/date from screenshots, specific I/O layout as reference. DO NOT repeat item specifics (Brand, Model, CPU, RAM, etc.) - they're displayed separately on eBay. DO NOT list what's included unless it clarifies something ambiguous. Keep it practical and efficient.\n\nTarget length: 1-2 short paragraphs maximum."},{id:"detailed-comprehensive",label:"Detailed & Comprehensive",instructions:'Detailed and comprehensive listings that maximize eBay search visibility through repetition and elaboration. This style may require seller review as it pushes boundaries on what can be safely stated. The goal is not verbosity for its own sake - every sentence should still provide useful information.\n\nCondition Description: Concise facts from seller notes only - work done, issues/defects highlighted by seller. Do not elaborate or add qualifiers not provided by seller.\n\nDescription: Start by elaborating on the condition description in longer form - same information but more detailed prose (e.g., "New CMOS battery" becomes "A new CMOS battery has been fitted"). Then repeat item specifics in conversational prose to maximize search keywords (e.g., "This motherboard features the Intel Z77 chipset with LGA1155 socket, supporting DDR3 memory"). Add only factual context visible from the model/specs (e.g., "The Core i5-3550 is a 3rd generation Intel processor", "Z77 is a high-end chipset compared to entry-level H61"). List what\'s included for clarity. Include detailed I/O layout from photos as reference. DO NOT claim implementation-specific capabilities that vary by manufacturer (e.g., don\'t state maximum RAM capacity unless visible in screenshots or seller notes, even if typical for that chipset). DO NOT add technical capabilities not explicitly shown in screenshots. DO NOT add qualifiers to condition not provided by seller. DO NOT infer use cases or compatibility claims.\n\nThe goal is maximum search visibility by elaborating on confirmed information only.'},{id:"custom",label:"Custom",instructions:""}],pricingStrategy:[{id:"undercut",label:"Quick Sale",instructions:"Price 10-15% below the cheapest comparable listing for fastest sale. Round down to .99 endings (e.g., \xa34.99, \xa312.99, not \xa35.00, \xa313.00)."},{id:"match-market",label:"Match Market",instructions:"Price at the average of comparable listings for balanced competitiveness. Round down to .99 endings (e.g., \xa34.99, \xa312.99, not \xa35.00, \xa313.00)."},{id:"buffer-offers",label:"Buffer for Offers",instructions:"Price 10-15% above market average to allow room for negotiation and offers. Round down to .99 endings (e.g., \xa34.99, \xa312.99, not \xa35.00, \xa313.00)."},{id:"premium",label:"Premium Pricing",instructions:"Price at the top of the market range, matching or exceeding the highest comparable listings. Round down to .99 endings (e.g., \xa34.99, \xa312.99, not \xa35.00, \xa313.00)."},{id:"custom",label:"Custom",instructions:""}]};function J(e){var t,s;let{isOpen:l,onClose:i,selectedDraftIds:o,onComplete:c}=e,[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)({category:!0,title:!0,itemSpecifics:!0,condition:!0,description:!0,pricing:!0}),[x,p]=(0,a.useState)("gpt-5-mini"),[g,f]=(0,a.useState)([]),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)("balanced"),[k,N]=(0,a.useState)("match-market"),C=(0,r._9)(),S=(null==C?void 0:C.username)==="testuser_spode",{item:L}=(0,w.H)("settings","user-preferences");(0,a.useEffect)(()=>{var e,t,s,n;if(!l)return;let a=(null==L||null==(t=L.taskInstructions)||null==(e=t.listingStyle)?void 0:e.preset)||"balanced",r=(null==L||null==(n=L.taskInstructions)||null==(s=n.pricingStrategy)?void 0:s.preset)||"match-market";v(a),N(r)},[l,L]),(0,a.useEffect)(()=>{l&&(async()=>{y(!0);try{let e=await fetch("/api/ai/models"),t=await e.json();if(t.success){let e=t.data.sort((e,t)=>e.id.localeCompare(t.id));f(e),e.length>0&&!e.find(e=>e.id===x)&&p(e[0].id)}}catch(e){console.error("Failed to fetch AI models:",e)}finally{y(!1)}})()},[l]);let I=e=>{m(t=>({...t,[e]:!t[e]}))},A=async()=>{let e=Object.entries(h).filter(e=>{let[t,s]=e;return s}).map(e=>{let[t,s]=e;return t});if(0===e.length)return void alert("Please select at least one task");u(!0);try{let t=(0,r._9)().access_token,s=await fetch("/api/ai/batch-process",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({draftIds:o,tasks:e,model:x,listingStyle:j,pricingStrategy:k})}),n=await s.json();n.success?(i(),c&&c(),console.log("Started processing ".concat(o.length," draft(s)"))):alert("Failed to start processing: ".concat(n.error))}catch(e){console.error("Batch process error:",e),alert("Failed to start processing: ".concat(e.message))}finally{u(!1)}},E=Object.values(h).filter(Boolean).length;return l?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"bg-slate-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto custom-scrollbar",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-slate-100",children:"AI Assist"}),(0,n.jsx)("button",{onClick:i,disabled:d,className:"text-slate-400 hover:text-slate-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,n.jsxs)("div",{className:"p-6 space-y-6",children:[S&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"AI Model:"}),(0,n.jsx)("div",{className:d?"opacity-50 pointer-events-none":"",children:(0,n.jsx)(G,{options:g.map(e=>({id:e.id,label:e.id})),value:x,onChange:p,placeholder:b?"Loading models...":"Select AI model..."})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Listing Style:"}),(0,n.jsx)("div",{className:d?"opacity-50 pointer-events-none":"",children:(0,n.jsx)(G,{options:Y.listingStyle.map(e=>({id:e.id,label:e.label})),value:(null==(t=Y.listingStyle.find(e=>e.id===j))?void 0:t.label)||null,onChange:e=>{let t=Y.listingStyle.find(t=>t.label===e);t&&v(t.id)},placeholder:"Select listing style..."})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Pricing Strategy:"}),(0,n.jsx)("div",{className:d?"opacity-50 pointer-events-none":"",children:(0,n.jsx)(G,{options:Y.pricingStrategy.map(e=>({id:e.id,label:e.label})),value:(null==(s=Y.pricingStrategy.find(e=>e.id===k))?void 0:s.label)||null,onChange:e=>{let t=Y.pricingStrategy.find(t=>t.label===e);t&&N(t.id)},placeholder:"Select pricing strategy..."})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Tasks to perform:"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-slate-700 rounded transition-colors ".concat(d?"opacity-50 cursor-not-allowed":"hover:bg-slate-600 cursor-pointer"),children:[(0,n.jsx)("input",{type:"checkbox",checked:h.category,onChange:()=>I("category"),disabled:d,className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm text-slate-100",children:"Category"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-slate-700 rounded transition-colors ".concat(d?"opacity-50 cursor-not-allowed":"hover:bg-slate-600 cursor-pointer"),children:[(0,n.jsx)("input",{type:"checkbox",checked:h.title,onChange:()=>I("title"),disabled:d,className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm text-slate-100",children:"Title"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-slate-700 rounded transition-colors ".concat(d?"opacity-50 cursor-not-allowed":"hover:bg-slate-600 cursor-pointer"),children:[(0,n.jsx)("input",{type:"checkbox",checked:h.itemSpecifics,onChange:()=>I("itemSpecifics"),disabled:d,className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm text-slate-100",children:"Item Specifics"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-slate-700 rounded transition-colors ".concat(d?"opacity-50 cursor-not-allowed":"hover:bg-slate-600 cursor-pointer"),children:[(0,n.jsx)("input",{type:"checkbox",checked:h.condition,onChange:()=>I("condition"),disabled:d,className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm text-slate-100",children:"Condition"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-slate-700 rounded transition-colors ".concat(d?"opacity-50 cursor-not-allowed":"hover:bg-slate-600 cursor-pointer"),children:[(0,n.jsx)("input",{type:"checkbox",checked:h.description,onChange:()=>I("description"),disabled:d,className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm text-slate-100",children:"Description"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-slate-700 rounded transition-colors ".concat(d?"opacity-50 cursor-not-allowed":"hover:bg-slate-600 cursor-pointer"),children:[(0,n.jsx)("input",{type:"checkbox",checked:h.pricing,onChange:()=>I("pricing"),disabled:d,className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm text-slate-100",children:"Pricing"})]})]})]}),(0,n.jsx)("div",{className:"p-3 bg-slate-700/50 rounded-lg border-l-4 border-blue-500",children:(0,n.jsx)("p",{className:"text-sm text-slate-300",children:"The more you refine your general instructions and per-category prompts in Settings, the more AI Assist writes exactly as you would. Visit Settings to customize AI Assist or check the documentation in Notes for more details."})})]}),(0,n.jsxs)("div",{className:"flex gap-3 p-6 border-t border-slate-700",children:[(0,n.jsx)("button",{onClick:i,disabled:d,className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed text-slate-100 rounded shadow transition-colors",children:"Cancel"}),(0,n.jsx)("button",{onClick:A,disabled:0===E||d,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white rounded shadow transition-colors font-medium flex items-center justify-center gap-2",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Starting..."]}):0===E?"Select Tasks":"Start Processing"})]})]})}):null}function K(){let{activeDraftId:e,setActiveDraftId:t,selectedDraftIds:s,setSelectedDraftIds:l,isMultiSelectMode:i,setIsMultiSelectMode:o,triggerAIAssist:c,setTriggerAIAssist:d}=m(),{item:u}=(0,w.H)("settings","user-preferences"),{item:h}=(0,w.H)("drafts",e),{setActiveView:g}=eg(),{setTriggerSearch:f}=(0,E.O)(),[b,y]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[L,I]=(0,a.useState)(!1),[A,T]=(0,a.useState)(null),[M,D]=(0,a.useState)(!1),[P,B]=(0,a.useState)(!1),[R,O]=(0,a.useState)(!1),F=(0,a.useRef)(null),_=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=e=>{F.current&&!F.current.contains(e.target)&&S(!1)};if(C)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[C]),(0,a.useEffect)(()=>{let e=e=>{_.current&&!_.current.contains(e.target)&&I(!1)};if(L)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[L]),(0,a.useEffect)(()=>{c&&(T([c]),d(null))},[c,d]);let U=async()=>{B(!0);try{let e=x(),s=(null==u?void 0:u.defaults)||{},n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Date.now();return{id:x(),title:"",notes:"",pictures:[],category:null,aspects:{},condition:null,conditionDescription:"",description:"",price:"0.00",format:"BuyItNow",quantity:1,offersEnabled:void 0===e.offersEnabled||e.offersEnabled,promotionEnabled:void 0!==e.promotionEnabled&&e.promotionEnabled,promotionPercentage:e.promotionPercentage||2,shippingPolicy:e.shippingPolicy||null,paymentPolicy:e.paymentPolicy||null,returnPolicy:e.returnPolicy||null,postcode:e.postcode||"",packageWeight:e.packageWeight||"2",packageSize:e.packageSize||"SMALL_PARCEL",createdAt:t,updatedAt:t}}(s);await j("drafts",e,n),t(e)}catch(e){console.error("Error creating draft:",e),alert("Failed to create draft")}finally{B(!1)}},z=async()=>{try{let e=await k("drafts",s);e.failedKeys.length>0&&alert("Failed to delete ".concat(e.failedKeys.length," draft(s)")),l([]),y(!1)}catch(e){console.error("Error deleting drafts:",e),alert("Failed to delete drafts")}},W=async()=>{try{await v("drafts",e),y(!1),t(null)}catch(e){console.error("Error deleting draft:",e),alert("Failed to delete draft. Please try again.")}},H=async s=>{let n=(0,r.c4)();O(!0);try{let a=await fetch("/api/ebay/batch-publish",{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({draftIds:s})}),r=await a.json();r.success?(D(!1),l([]),e&&t(null),console.log("Started publishing ".concat(s.length," draft(s)"))):alert("Failed to start publishing: ".concat(r.error))}catch(e){console.error("Batch publish error:",e),alert("Failed to start publishing: ".concat(e.message))}finally{O(!1)}};return(0,n.jsxs)("div",{className:"flex items-center sm:gap-2 flex-wrap sm:flex-nowrap",children:[(0,n.jsx)("div",{className:"w-full sm:w-auto mb-2 sm:mb-0 sm:mr-4",children:(0,n.jsx)(p,{})}),!e&&(0,n.jsxs)("div",{className:"ml-auto flex gap-2 w-full sm:w-auto",children:[(0,n.jsx)("div",{className:"flex-1 sm:flex-none",children:(0,n.jsx)("button",{onClick:()=>{o(!i),i&&l([])},className:"w-full px-4 py-2 rounded shadow transition-colors flex items-center justify-center gap-2 ".concat(i?"bg-green-600 hover:bg-green-700 text-white":"bg-slate-700 hover:bg-slate-600 text-white"),title:i?"Switch to single select mode":"Switch to multi select mode",children:i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),(0,n.jsx)("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),(0,n.jsx)("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"}),(0,n.jsx)("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"})]}),(0,n.jsx)("span",{children:"Multi"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,n.jsx)("polyline",{points:"9 11 12 14 15 10"})]}),(0,n.jsx)("span",{children:"Single"})]})})}),(0,n.jsxs)("div",{className:"relative flex-1 sm:flex-none",ref:F,children:[(0,n.jsxs)("button",{onClick:()=>S(!C),className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded shadow transition-colors flex items-center justify-center gap-2",children:["Actions",(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),C&&(0,n.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-blue-700 rounded-lg shadow-lg z-50 overflow-hidden",children:[(0,n.jsxs)("button",{onClick:()=>{U(),S(!1)},disabled:P,className:"w-full text-left px-4 py-3 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M12 5v14M5 12h14"})}),P?"Creating...":"New"]}),(0,n.jsxs)("button",{onClick:()=>{S(!1),T(s)},disabled:!i||0===s.length,className:"w-full text-left px-4 py-3 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"})}),"AI\xa0Assist"]}),(0,n.jsxs)("button",{onClick:()=>{S(!1),D(!0)},disabled:!i||0===s.length,className:"w-full text-left px-4 py-3 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M12 19V5M5 12l7-7 7 7"})}),"Publish"]}),(0,n.jsxs)("button",{onClick:()=>{S(!1),y(!0)},disabled:!i||0===s.length,className:"w-full text-left px-4 py-3 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})}),"Delete"]})]})]})]}),e&&(0,n.jsxs)("div",{className:"ml-auto flex gap-2 w-full sm:w-auto",children:[(0,n.jsx)("div",{className:"flex-1 sm:flex-none",children:(0,n.jsxs)("button",{onClick:()=>t(null),className:"w-full bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded shadow transition-colors flex items-center justify-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"15 18 9 12 15 6"})}),"Back"]})}),(0,n.jsxs)("div",{className:"relative flex-1 sm:flex-none",ref:_,children:[(0,n.jsxs)("button",{onClick:()=>I(!L),className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded shadow transition-colors flex items-center justify-center gap-2",children:["Actions",(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),L&&(0,n.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-blue-700 rounded-lg shadow-lg z-50 overflow-hidden",children:[(0,n.jsxs)("button",{onClick:()=>{I(!1),D(!0)},className:"w-full text-left px-4 py-3 hover:bg-blue-600 text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M12 19V5M5 12l7-7 7 7"})}),"Publish"]}),(0,n.jsxs)("button",{onClick:()=>{I(!1),h&&(f(h.title||h.notes),g("research"))},className:"w-full text-left px-4 py-3 hover:bg-blue-600 text-white transition-colors flex items-center gap-2",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("path",{d:"m21 21-4.35-4.35"})]}),"Research"]}),(0,n.jsxs)("button",{onClick:()=>{I(!1),T([e])},className:"w-full text-left px-4 py-3 hover:bg-blue-600 text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"})}),"AI\xa0Assist"]}),(0,n.jsxs)("button",{onClick:()=>{I(!1),y(!0)},className:"w-full text-left px-4 py-3 hover:bg-red-700 text-white transition-colors flex items-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})}),"Delete"]})]})]})]}),(0,n.jsx)(N.A,{isOpen:b,onClose:()=>y(!1),onConfirm:e?W:z,title:"Delete Draft",message:e?"Are you sure you want to delete this draft?":"Are you sure you want to delete ".concat(s.length," draft").concat(1!==s.length?"s":"","?"),confirmText:"Delete",type:"confirm"}),(0,n.jsx)(J,{isOpen:null!==A,onClose:()=>T(null),selectedDraftIds:A||[],onComplete:()=>{s.length>0&&l([]),e&&t(null)}}),(0,n.jsx)(N.A,{isOpen:M,onClose:()=>D(!1),onConfirm:()=>{H(e?[e]:s)},title:"Confirm Publish",message:e?"You are about to publish this draft to eBay.\n\nThis action cannot be cancelled once started.\n\nDo you want to continue?":"You are about to publish ".concat(s.length," draft").concat(1!==s.length?"s":""," to eBay.\n\nThis action cannot be cancelled once started.\n\nDo you want to continue?"),confirmText:"Publish",type:"confirm"})]})}let X=e=>{let{name:t,value:s}=e,l=Array.isArray(s)?s.join(", "):s;return(0,n.jsxs)("div",{className:"inline-flex items-center bg-slate-700 text-xs rounded px-2 py-1",children:[(0,n.jsxs)("span",{className:"mr-1 text-blue-300",children:[t,":"]}),(0,n.jsx)("span",{className:"text-slate-300",children:l})]})},Q=e=>{let{item:t,onImageClick:s,onTitleClick:l,transparent:a=!1,actionButtons:r=[],accountType:i="INDIVIDUAL"}=e,o=t.pictureURLs?t.pictureURLs[0]:t.imageUrl,c=t.pictureURLs&&t.pictureURLs.length>1,d=t.title||t.notes||"No title or notes",u=parseFloat(t.price)||0,h="BUSINESS"===i,m=h?0:function(e){let t,s=parseFloat(e)||0;return t=.1+.07*Math.min(s,20),s>20&&(t+=.04*Math.min(s-20,280)),s>300&&(t+=.02*Math.min(s-300,3700)),t}(u),x=h?u:function(e){let t=Math.floor(e),s=e-t;return .01>Math.abs(s-.49)||.01>Math.abs(s-.99)?e:[t-1+.99,t+.49,t+.99].reduce((t,s)=>Math.abs(s-e)<Math.abs(t-e)?s:t)}(u+m),p=null;return t.specifics&&(p=Object.entries(t.specifics).map((e,t)=>{let[s,l]=e;return(0,n.jsx)(X,{name:s,value:l},t)})),(0,n.jsxs)("div",{className:"".concat(a?"bg-transparent":"bg-slate-800"," p-3 rounded-md mb-4"),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("div",{className:"flex flex-col ml-0 mr-4",children:[(0,n.jsx)("div",{className:"relative",children:o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:o,alt:"Product image loading...",title:d,className:"w-24 h-24 sm:w-40 sm:h-40 object-cover rounded-md cursor-pointer hover:opacity-90 transition-opacity",loading:"lazy",onClick:()=>s&&s(t)}),c&&(0,n.jsx)("div",{className:"absolute top-1 right-1 bg-slate-800 bg-opacity-70 text-white text-xs rounded-full p-1",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"9",y:"3",width:"12",height:"12",rx:"2",ry:"2"}),(0,n.jsx)("rect",{x:"3",y:"9",width:"12",height:"12",rx:"2",ry:"2"})]})})]}):(0,n.jsx)("div",{className:"w-24 h-24 sm:w-40 sm:h-40 bg-slate-900 rounded-md flex items-center justify-center",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-600",children:[(0,n.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,n.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,n.jsx)("polyline",{points:"21 15 16 10 5 21"})]})})}),r.length>0&&(0,n.jsx)("div",{className:"hidden sm:flex sm:gap-1 mt-2 w-40",children:r.map((e,t)=>(0,n.jsx)("div",{className:"flex-1 [&>*]:w-full [&>*]:h-8 [&>*]:flex [&>*]:justify-center [&>*]:items-center",children:e},t))})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-white font-medium group",children:(0,n.jsx)("span",{onClick:()=>l&&l(t),className:"hover:text-blue-300 cursor-pointer transition-colors duration-200",title:"View details",children:d})}),u>0&&(0,n.jsxs)("p",{className:"text-slate-400 text-sm",children:[(0,n.jsxs)("span",{className:"text-green-400",children:["\xa3",x.toFixed(2)]}),!h&&(0,n.jsxs)("span",{className:"text-slate-500 text-xs",children:[" (\xa3",u.toFixed(2)," + \xa3",m.toFixed(2)," buyer's fee)"]})]})]}),p&&(0,n.jsx)("div",{className:"hidden sm:flex sm:flex-wrap mt-2 gap-1",children:p})]})]}),(r.length>0||p)&&(0,n.jsxs)("div",{className:"sm:hidden mt-2 mx-0 flex flex-wrap gap-1",children:[r,p]})]})};function Z(e){let{draft:t,onEdit:s,onDelete:l,isSelected:i=!1,onToggleSelect:o,isMultiSelectMode:c=!1,accountType:d="INDIVIDUAL"}=e,{setActiveView:u}=eg(),{setTriggerSearch:h}=(0,E.O)(),{setTriggerAIAssist:x}=m(),p=(0,r._9)().username,g="processing"===t.status,f="error"===t.status,b=t.processingType,y=t.processingError,w="ai"===b?"AI Assist":"publish"===b?t.publishedListingUrl?"Promoting":"Publishing":"Processing",[j,v]=(0,a.useState)(0),k=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(!g||!t.startTime){v(0),k.current=!1;return}let e=()=>{v(Math.floor((Date.now()-t.startTime)/1e3))};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[g,t.startTime]),(0,a.useEffect)(()=>{g&&t.startTime&&!(j<600)&&!k.current&&(k.current=!0,(async()=>{try{let e=(0,r._9)().access_token,s=await fetch("/api/data/drafts/".concat(t._key),{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let{value:n}=await s.json();if("processing"!==n.status)return void console.log("[Draft Card] Task completed while checking timeout, no action needed");let l=new Date().toISOString().replace("T"," ").substring(0,19),a=((Date.now()-t.startTime)/1e3).toFixed(1);n.status="error",n.processingType=null,n.processingError="".concat(w," Timed Out"),delete n.startTime,n.log||(n.log=""),n.log+="\n✗ Processing timed out after 10 minutes\n",n.log+="[".concat(l,"] Failed (Duration: ").concat(a,"s)\n"),await fetch("/api/data/drafts/".concat(t._key),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({value:n})})}}catch(e){console.error("Failed to set timeout state:",e)}})())},[j,g,t.startTime,t._key,b]);let N=t.pictures&&t.pictures.length>0?t.pictures[0]:null,C={imageUrl:N&&p?"/images/".concat(p,"/").concat(N,".jpg?size=300"):null,title:t.title,notes:t.notes,price:t.price||"0",specifics:t.aspects||null},S=[];!g&&(t.publishedListingId?S.push((0,n.jsx)("a",{href:"https://www.ebay.co.uk/lstng?mode=ReviseItem&itemId=".concat(t.publishedListingId),target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"inline-flex items-center bg-blue-700 text-white text-xs rounded px-2 py-1 hover:bg-blue-600 transition-colors duration-200",title:"Edit on eBay",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})},"edit")):S.push((0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),s()},className:"inline-flex items-center bg-blue-700 text-white text-xs rounded px-2 py-1 hover:bg-blue-600 transition-colors duration-200",title:"Edit draft",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})},"edit")),t.publishedListingUrl&&S.push((0,n.jsx)("a",{href:t.publishedListingUrl,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"inline-flex items-center bg-green-700 text-white text-xs rounded px-2 py-1 hover:bg-green-600 transition-colors duration-200",title:"View on eBay",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M10 6H6a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-4M14 4h6m0 0v6m0-6L10 14"})})},"view-ebay")),t.publishedListingUrl||S.push((0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),x(t._key)},className:"inline-flex items-center bg-indigo-700 text-white text-xs rounded px-2 py-1 hover:bg-indigo-600 transition-colors duration-200",title:"AI Assist",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"})})},"ai-assist")),t.publishedListingUrl||S.push((0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),h(t.title||t.notes),u("research")},className:"inline-flex items-center bg-purple-700 text-white text-xs rounded px-2 py-1 hover:bg-purple-600 transition-colors duration-200",title:"Research this item",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("path",{d:"m21 21-4.35-4.35"})]})},"research")),l&&S.push((0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"inline-flex items-center bg-red-700 text-white text-xs rounded px-2 py-1 hover:bg-red-600 transition-colors duration-200",title:"Delete draft",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})})},"delete")));let L=e=>{if(!g){if(t.publishedListingId){let s="https://www.ebay.co.uk/lstng?mode=ReviseItem&itemId=".concat(t.publishedListingId),n=window.open(s,"_blank");e.metaKey||e.ctrlKey||!n||n.focus();return}if(!c&&s)return void s();o&&o()}};return(0,n.jsxs)("div",{onClick:L,className:"rounded-lg shadow-md hover:shadow-lg transition-all cursor-pointer relative ".concat(i?"bg-[#293748]":"bg-slate-800"),children:[i&&!g&&(0,n.jsx)("div",{className:"absolute top-2 right-2 z-20 bg-blue-500 rounded-full p-1",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"20 6 9 17 4 12"})})}),f&&y&&(0,n.jsxs)("div",{className:"absolute bottom-2 right-2 z-20 bg-red-600 rounded px-2 py-1 flex items-center gap-1",title:y,children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),(0,n.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,n.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),(0,n.jsx)("span",{className:"text-white text-xs font-medium",children:y})]}),g&&(0,n.jsx)("div",{className:"absolute inset-0 bg-slate-900 bg-opacity-75 rounded-lg flex items-center justify-center z-10",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{className:"text-sm ".concat(j>=300?"text-yellow-400":"text-slate-300"),children:j>0?"".concat(w," (").concat((e=>{if(e<60)return"".concat(e,"s");let t=Math.floor(e/60);return"".concat(t,"m ").concat(e%60,"s")})(j),")"):"".concat(w,"...")}),j>=300&&(0,n.jsx)("span",{className:"text-xs text-yellow-400 text-center px-2",children:"This is taking longer than usual..."})]})}),(0,n.jsx)(Q,{item:C,onImageClick:L,onTitleClick:L,actionButtons:S,transparent:!0,accountType:d})]})}function $(){var e;let{items:t,isLoading:s,error:l}=y("drafts",{orderBy:"updated_at",order:"desc"}),{setActiveDraftId:r,selectedDraftIds:i=[],setSelectedDraftIds:o,isMultiSelectMode:c}=m(),{item:d}=(0,w.H)("settings","user-preferences"),u=(null==d||null==(e=d.defaults)?void 0:e.accountType)||"INDIVIDUAL",[h,x]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(null),j=e=>{c?o(i.includes(e)?i.filter(t=>t!==e):[...i,e]):o(i.includes(e)&&1===i.length?[]:[e])},k=e=>{r(e)},C=async()=>{if(h){g(!0);try{await v("drafts",h),x(null)}catch(e){console.error("Error deleting draft:",e),b("Failed to delete draft. Please try again."),x(null)}finally{g(!1)}}};if(s)return(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"text-center text-slate-400",children:(0,n.jsx)("p",{className:"text-lg",children:"Loading drafts..."})})});if(l)return(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsxs)("div",{className:"text-center text-red-400",children:[(0,n.jsx)("p",{className:"text-lg",children:"Error loading drafts"}),(0,n.jsx)("p",{className:"text-sm",children:l})]})});if(0===t.length)return(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"text-center text-slate-400",children:(0,n.jsx)("p",{className:"text-lg",children:"No drafts"})})});let S=t.filter(e=>!e.publishedListingUrl),L=t.filter(e=>e.publishedListingUrl);return(0,n.jsxs)("div",{className:"px-4 pb-4 overflow-y-auto custom-scrollbar",children:[S.length>0&&(0,n.jsx)("div",{className:"space-y-2",children:S.map(e=>(0,n.jsx)(Z,{draft:e,onEdit:()=>k(e._key),onDelete:()=>x(e._key),isSelected:i.includes(e._key),onToggleSelect:()=>j(e._key),isMultiSelectMode:c,accountType:u},e._key))}),L.length>0&&(0,n.jsxs)(n.Fragment,{children:[S.length>0&&(0,n.jsx)("div",{className:"h-6"}),(0,n.jsxs)("div",{className:"bg-slate-800 rounded-lg px-4 py-3 mb-4",children:[(0,n.jsx)("p",{className:"text-slate-300 text-sm",children:(0,n.jsx)("strong",{className:"text-slate-200",children:"Published Listings"})}),(0,n.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:"Published drafts are shown here for reference and can be safely deleted."})]}),(0,n.jsx)("div",{className:"space-y-2",children:L.map(e=>(0,n.jsx)(Z,{draft:e,onEdit:()=>k(e._key),onDelete:()=>x(e._key),isSelected:i.includes(e._key),onToggleSelect:()=>j(e._key),isMultiSelectMode:c,accountType:u},e._key))})]}),(0,n.jsx)(N.A,{isOpen:null!==h,onClose:()=>x(null),onConfirm:C,title:"Delete Draft",message:"Are you sure you want to delete this draft?",confirmText:p?"Deleting...":"Delete",type:"confirm"}),(0,n.jsx)(N.A,{isOpen:!!f,onClose:()=>b(null),onConfirm:()=>b(null),title:"Error",message:f||"",confirmText:"OK",type:"alert"})]})}var ee=s(1130),et=s.n(ee);function es(e){let{onClose:t,onCapture:s,draftId:l,currentPhotoCount:i=0}=e,{cameraZoom:o,setCameraZoom:c}=m(),d=(0,a.useRef)(null),u=(0,a.useRef)(null),h=(0,a.useRef)(null),x=(0,a.useRef)(null),p=(0,a.useRef)(null),g=(0,a.useRef)(null),f=(0,a.useRef)(null),[b,y]=(0,a.useState)(!1),[w,j]=(0,a.useState)(null),[v,k]=(0,a.useState)([]),[N,C]=(0,a.useState)(o||1),[S,L]=(0,a.useState)(null),[I,A]=(0,a.useState)(!1),[E,T]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return async function(){try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw Error("Camera access requires HTTPS. Please access this site via https:// or localhost");let t=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"},width:{ideal:4096},height:{ideal:4096}},audio:!1});if(!e)return void t.getTracks().forEach(e=>e.stop());h.current=t;let s=t.getVideoTracks()[0];x.current=s;let n=s.getCapabilities();if(n.zoom){L({min:n.zoom.min,max:n.zoom.max,step:n.zoom.step||.1});let e=o&&o>=n.zoom.min&&o<=n.zoom.max?o:n.zoom.min;C(e),await s.applyConstraints({advanced:[{zoom:e}]})}d.current&&(d.current.srcObject=t,d.current.onloadedmetadata=()=>{e&&y(!0)})}catch(t){console.error("Camera error:",t),e&&j(t.message||"Failed to access camera")}}(),()=>{e=!1,h.current&&h.current.getTracks().forEach(e=>e.stop())}},[]);let M=async e=>{let t=parseFloat(e);if(C(t),c(t),x.current&&S)try{await x.current.applyConstraints({advanced:[{zoom:t}]})}catch(e){console.error("Zoom error:",e)}},D=(e,t)=>{let s=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(s*s+n*n)},P=e=>{2===e.touches.length&&S&&(p.current=D(e.touches[0],e.touches[1]),g.current=N)},B=e=>{if(2===e.touches.length&&S&&p.current){e.preventDefault();let t=D(e.touches[0],e.touches[1])/p.current,s=g.current*t;M(s=Math.max(S.min,Math.min(S.max,s)))}},R=e=>{e.touches.length<2&&(p.current=null,g.current=null)};(0,a.useEffect)(()=>{let e=f.current;if(!e)return;let t={passive:!1};return e.addEventListener("touchstart",P,t),e.addEventListener("touchmove",B,t),e.addEventListener("touchend",R,t),()=>{e.removeEventListener("touchstart",P),e.removeEventListener("touchmove",B),e.removeEventListener("touchend",R)}},[N,S]);let O=async e=>{if(!x.current)return;let t=e.currentTarget.getBoundingClientRect(),s=(e.clientX-t.left)/t.width,n=(e.clientY-t.top)/t.height;try{let e=x.current.getCapabilities();e.focusMode&&e.focusMode.includes("single-shot")?await x.current.applyConstraints({advanced:[{focusMode:"single-shot",pointsOfInterest:[{x:s,y:n}]}]}):e.focusMode&&e.focusMode.includes("continuous")&&await x.current.applyConstraints({advanced:[{focusMode:"continuous"}]})}catch(e){console.error("Focus error:",e)}},F=async()=>{if(0===v.length)return void t();T(!0);try{let e=[];for(let t of v){let s=await fetch("/api/images",{method:"POST",headers:{Authorization:"Bearer ".concat((0,r._9)().access_token),"Content-Type":"application/json"},body:JSON.stringify({image:t})});if(!s.ok)throw Error("Failed to upload image: ".concat(s.status));let n=await s.json();e.push(n.hash)}s(e)}catch(e){console.error("Error saving photos:",e),alert("Failed to save photos: ".concat(e.message)),T(!1)}};return(0,n.jsxs)("div",{className:"fixed inset-0 z-50 bg-slate-950 flex flex-col max-lg:landscape:flex-row",children:[(0,n.jsxs)("div",{className:"bg-slate-900 p-4 flex items-center justify-between max-lg:landscape:hidden",children:[(0,n.jsxs)("h2",{className:"text-white text-lg font-medium",children:["Take Photos ",v.length>0&&"(".concat(v.length,")")]}),(0,n.jsx)("button",{onClick:F,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Done"})]}),(0,n.jsxs)("div",{className:"flex-1 min-h-0 flex items-center justify-center relative max-lg:landscape:order-2 max-lg:landscape:items-stretch",children:[w&&(0,n.jsxs)("div",{className:"text-white text-center",children:[(0,n.jsx)("p",{className:"text-red-400 mb-2",children:"Camera Error"}),(0,n.jsx)("p",{className:"text-sm text-slate-400",children:w})]}),!w&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{ref:f,className:"relative h-full w-auto max-w-full aspect-square overflow-hidden touch-none max-lg:landscape:max-h-full",onClick:O,children:[(0,n.jsx)("video",{ref:d,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute inset-0 w-full h-full object-cover"}),I&&(0,n.jsx)("div",{className:"absolute inset-0 bg-white pointer-events-none"}),!b&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-white",children:"Loading camera..."})})]})})]}),(0,n.jsxs)("div",{className:"bg-slate-800 px-4 py-3 max-lg:landscape:order-1 max-lg:landscape:flex max-lg:landscape:flex-col max-lg:landscape:w-auto max-lg:landscape:py-4 max-lg:landscape:px-2",children:[(0,n.jsx)("div",{className:"flex items-center justify-between mb-2 max-lg:landscape:mb-3 max-lg:landscape:hidden",children:(0,n.jsxs)("p",{className:"text-slate-400 text-sm",children:[v.length,"/",24-i," photos"]})}),(0,n.jsx)("div",{className:"flex gap-2 overflow-x-auto min-h-[4rem] max-lg:landscape:flex-col max-lg:landscape:overflow-y-auto max-lg:landscape:overflow-x-visible max-lg:landscape:min-h-0 max-lg:landscape:min-w-[4rem]",children:v.length>0?v.map((e,t)=>(0,n.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,n.jsx)("img",{src:e,alt:"Captured ".concat(t+1),className:"w-16 h-16 object-cover rounded"}),(0,n.jsx)("button",{onClick:()=>{k(e=>e.filter((e,s)=>s!==t))},className:"absolute top-0.5 right-0.5 bg-black/50 hover:bg-black/70 text-white rounded p-0.5 z-10",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,n.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},t)):(0,n.jsx)("div",{className:"w-16 h-16 bg-slate-700 rounded flex items-center justify-center",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-500",children:[(0,n.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,n.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,n.jsx)("polyline",{points:"21 15 16 10 5 21"})]})})})]}),!w&&(0,n.jsxs)("div",{className:"bg-slate-900 p-6 max-lg:landscape:order-3 max-lg:landscape:flex max-lg:landscape:flex-col max-lg:landscape:justify-start max-lg:landscape:flex-1 max-lg:landscape:max-w-[33vw] max-lg:landscape:p-4",children:[(0,n.jsx)("button",{onClick:F,className:"hidden max-lg:landscape:block bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors mb-6 max-lg:landscape:mb-0 max-lg:landscape:flex-shrink-0",children:"Done"}),b&&(0,n.jsx)(n.Fragment,{children:S?(0,n.jsxs)("div",{className:"mb-6 max-lg:landscape:mb-0 max-lg:landscape:flex-1 max-lg:landscape:flex max-lg:landscape:flex-col max-lg:landscape:justify-center max-lg:landscape:items-center max-lg:landscape:py-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2 max-lg:landscape:mb-4 w-full",children:[(0,n.jsx)("label",{className:"text-white text-sm font-medium max-lg:landscape:text-xs max-lg:landscape:hidden",children:"Zoom"}),(0,n.jsxs)("span",{className:"text-white text-sm font-mono bg-slate-800 px-3 py-1 rounded max-lg:landscape:text-xs max-lg:landscape:px-2 max-lg:landscape:py-1",children:[N.toFixed(1),"x"]})]}),(0,n.jsx)("input",{type:"range",min:S.min,max:S.max,step:S.step,value:N,onChange:e=>M(e.target.value),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider",style:{accentColor:"#3b82f6"}})]}):(0,n.jsx)("div",{className:"mb-4 text-slate-400 text-xs text-center max-lg:landscape:mb-0 max-lg:landscape:flex-1 max-lg:landscape:flex max-lg:landscape:items-center max-lg:landscape:justify-center max-lg:landscape:text-[10px] max-lg:landscape:py-4",children:"Zoom not supported"})}),(0,n.jsxs)("button",{onClick:()=>{if(!d.current||!u.current)return;let e=d.current,t=u.current,s=e.videoWidth,n=e.videoHeight,l=Math.min(s,n),a=(s-l)/2,r=(n-l)/2;t.width=l,t.height=l,t.getContext("2d").drawImage(e,a,r,l,l,0,0,l,l);let i=t.toDataURL("image/jpeg",.95);k(e=>[...e,i]),A(!0),setTimeout(()=>A(!1),150)},disabled:!b||i+v.length>=24,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white py-4 rounded-lg text-lg font-medium transition-colors flex items-center justify-center gap-2 max-lg:landscape:px-6 max-lg:landscape:py-3 max-lg:landscape:text-base max-lg:landscape:flex-shrink-0",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"max-lg:landscape:w-5 max-lg:landscape:h-5",children:[(0,n.jsx)("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),(0,n.jsx)("circle",{cx:"12",cy:"13",r:"3"})]}),"Capture"]})]}),(0,n.jsx)("canvas",{ref:u,className:"hidden"}),E&&(0,n.jsx)("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-white mb-4"}),(0,n.jsx)("p",{className:"text-white text-lg",children:"Saving photos..."})]})})]})}function en(e){let{hash:t,index:s,onDelete:l,onRotate:i,onView:o}=e,[c,d]=(0,a.useState)(!1),u=(0,r._9)(),h=null==u?void 0:u.username,m=h?"/images/".concat(h,"/").concat(t,".jpg?size=300"):null,x=h?"/images/".concat(h,"/").concat(t,".jpg"):null;return(0,n.jsxs)("div",{className:"aspect-square bg-slate-800 rounded-lg overflow-visible relative group",children:[(0,n.jsx)("div",{className:"w-full h-full rounded-lg overflow-hidden cursor-pointer",onClick:()=>{o&&o(x)},children:m?(0,n.jsxs)(n.Fragment,{children:[!c&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-800",children:(0,n.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,n.jsx)("img",{src:m,alt:"Photo ".concat(s+1),className:"w-full h-full object-cover",onLoad:()=>d(!0)})]}):(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs",children:"Loading..."})}),(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"absolute top-1 right-1 bg-black/50 hover:bg-black/70 text-white rounded p-1 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity z-10",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,n.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})}),i&&(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},className:"absolute bottom-1 right-1 bg-black/50 hover:bg-black/70 text-white rounded p-1 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity z-10",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})})})]})}function el(e){let{value:t,onChange:s}=e,[l,r]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[c,d]=(0,a.useState)([]),[u,h]=(0,a.useState)(!1),[m,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),f=(0,a.useRef)(null),b=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(i.length<2){d([]),p||x(!1);return}return f.current&&clearTimeout(f.current),f.current=setTimeout(async()=>{h(!0);try{let e=await fetch("/api/categories/search?q=".concat(encodeURIComponent(i),"&limit=20")),t=await e.json();t.results&&(d(t.results),x(!0))}catch(e){console.error("Category search error:",e)}finally{h(!1)}},300),()=>{f.current&&clearTimeout(f.current)}},[i,p]),(0,a.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&(x(!1),g(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let y=t?t.name:"";return(0,n.jsxs)("div",{ref:b,className:"relative",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"text",value:p?l:y,onChange:e=>{let t=e.target.value;r(t),o(t),g(!0),x(!0)},onFocus:()=>{r(""),o(t?t.name:""),g(!0),x(!0)},onKeyDown:e=>{"Escape"===e.key&&(f.current&&clearTimeout(f.current),o(""),x(!1),g(!1),e.target.blur())},placeholder:"Search for a category...",className:"w-full bg-slate-700 text-slate-100 text-base border border-slate-600 rounded-lg px-4 py-2 pr-10 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),t&&!p&&(0,n.jsx)("button",{onClick:()=>{s(null),r(""),o("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-200",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),m&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 z-10",onClick:()=>{x(!1),g(!1)}}),m&&(0,n.jsxs)("div",{className:"absolute z-20 w-full mt-1 bg-slate-800 border border-slate-600 rounded-lg max-h-64 overflow-auto custom-scrollbar",style:{boxShadow:"0 4px 20px rgba(241, 245, 249, 0.15)"},children:[u&&(0,n.jsx)("div",{className:"px-4 py-3 text-slate-400 text-sm",children:"Searching..."}),!u&&0===c.length&&i.length>=2&&(0,n.jsx)("div",{className:"px-4 py-3 text-slate-400 text-sm",children:"No categories found"}),!u&&i.length<2&&(0,n.jsx)("div",{className:"px-4 py-3 text-slate-400 text-sm",children:"Type at least 2 characters to search"}),!u&&c.length>0&&(0,n.jsx)(n.Fragment,{children:c.map(e=>(0,n.jsxs)("button",{onClick:()=>{s(e),r(""),o(""),x(!1),g(!1),d([])},className:"w-full px-4 py-2 text-left hover:bg-slate-700 transition-colors border-b border-slate-700 last:border-b-0",children:[(0,n.jsx)("div",{className:"text-slate-100 text-base",children:e.name}),(0,n.jsx)("div",{className:"text-slate-400 text-xs",children:e.path})]},e.id))})]})]})}function ea(e){let{aspect:t,value:s,onChange:l}=e,a=t.aspectConstraint,r=a.aspectRequired,i="MULTI"===a.itemToAspectCardinality,o=t.aspectValues&&t.aspectValues.length>0,c="FREE_TEXT"===a.aspectMode;return(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:[t.localizedAspectName,r&&(0,n.jsx)("span",{className:"text-red-400 ml-1",children:"*"})]}),o?(0,n.jsx)(G,{options:(t.aspectValues||[]).map(e=>({id:e.localizedValue,label:e.localizedValue})),value:s,onChange:l,isMulti:i,allowCustom:c,placeholder:"Search or select..."}):(0,n.jsx)("input",{type:"text",value:s||"",onChange:e=>l(e.target.value),placeholder:"Enter ".concat(t.localizedAspectName,"..."),className:"w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})}function er(e){let{sections:t,activeSection:s,onSectionClick:l}=e,r=(0,a.useRef)(null),i=(0,a.useRef)([]);return(0,a.useEffect)(()=>{r.current&&i.current[s]&&i.current[s].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[s]),(0,n.jsx)("div",{className:"flex-shrink-0 bg-slate-900/50 sticky top-0 z-10",children:(0,n.jsxs)("div",{className:"relative px-4 pb-2",children:[(0,n.jsxs)("div",{ref:r,className:"jsx-c2def58941a14be3 overflow-x-auto snap-x scroll-smooth scrollbar-hide",children:[(0,n.jsx)(et(),{id:"c2def58941a14be3",children:"div.jsx-c2def58941a14be3::-webkit-scrollbar{display:none}"}),(0,n.jsx)("div",{className:"jsx-c2def58941a14be3 flex gap-2 min-w-max pr-4",children:t.map((e,t)=>(0,n.jsxs)("button",{ref:e=>i.current[t]=e,onClick:()=>l(t),className:"jsx-c2def58941a14be3 "+"snap-start px-4 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-2 ".concat(s===t?"bg-green-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:[e.icon,(0,n.jsx)("span",{className:"jsx-c2def58941a14be3",children:e.label})]},e.id))})]}),(0,n.jsx)("div",{className:"absolute top-0 right-4 w-8 h-full bg-gradient-to-l from-slate-900 to-transparent pointer-events-none"})]})})}function ei(e){let{imageUrl:t,onClose:s}=e;return((0,a.useEffect)(()=>{if(t&&"undefined"!=typeof document){let e=document.querySelector('meta[name="viewport"]');if(e){let t=e.getAttribute("content");return e.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes"),()=>{e.setAttribute("content",t)}}}},[t]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s()};if(t)return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t,s]),t)?(0,n.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:e=>{e.target===e.currentTarget&&s()},children:[(0,n.jsx)("button",{onClick:s,className:"absolute top-4 right-4 bg-slate-800 hover:bg-slate-700 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-lg z-10",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),t?(0,n.jsx)("img",{src:t,alt:"Full size",className:"max-w-full max-h-full object-contain",draggable:!1}):(0,n.jsx)("div",{className:"text-white",children:"Loading..."})]}):null}function eo(e){let{loading:t,error:s,onRetry:l,onCreateDefaults:a,creatingDefaults:r,loadingMessage:i="Loading...",children:o}=e;if(r)return(0,n.jsx)("div",{className:"rounded-lg mb-6",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-slate-400",children:[(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{className:"text-sm",children:"Creating preset policies..."})]})});if(t)return(0,n.jsx)("div",{className:"rounded-lg mb-6",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-slate-400",children:[(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{className:"text-sm",children:i})]})});if(s){let e=i.replace("Loading ","Failed to load ").replace("...","");return(0,n.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 mb-6",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-red-400 flex-shrink-0 mt-0.5",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,n.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("p",{className:"text-sm text-red-300 mb-2",children:[e,". Please try again."]}),a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-sm text-red-200/80 mb-2",children:"Business policies are mandatory for publishing via the API."}),(0,n.jsxs)("p",{className:"text-sm text-red-200/80 mb-3",children:["We can create a sensible default set for you, which you can then manage in ",(0,n.jsx)("a",{href:"https://www.ebay.co.uk/bp/manage",target:"_blank",rel:"noopener noreferrer",className:"text-red-300 hover:text-red-200 underline",children:"eBay Business Policies"}),"."]})]}),(0,n.jsxs)("div",{className:"mt-2 flex gap-4",children:[l&&(0,n.jsx)("button",{onClick:l,className:"text-sm text-red-400 hover:text-red-300 underline",children:"Retry"}),a&&(0,n.jsx)("button",{onClick:a,className:"text-sm text-red-400 hover:text-red-300 underline",children:"Create Default Policies"})]})]})]})})}return(0,n.jsx)(n.Fragment,{children:o})}function ec(e){let{value:t,onChange:s,className:l="",...a}=e;return(0,n.jsxs)("div",{className:"grid",children:[(0,n.jsx)("textarea",{value:t,onChange:s,className:"col-start-1 row-start-1 resize-none overflow-hidden ".concat(l),...a}),(0,n.jsxs)("div",{className:"col-start-1 row-start-1 invisible whitespace-pre-wrap break-words pointer-events-none ".concat(l),style:{border:"1px solid transparent"},"aria-hidden":"true",children:[t+" "," "]})]})}var ed=s(7471);function eu(e){let t,s=parseFloat(e)||0;return t=.1+.07*Math.min(s,20),s>20&&(t+=.04*Math.min(s-20,280)),s>300&&(t+=.02*Math.min(s-300,3700)),t}function eh(){var e,t,s,l,i,o,c,d,u;let{activeDraftId:h,setActiveDraftId:x}=m(),{item:p,setItem:g,isLoading:f,error:b}=(0,w.H)("drafts",h),{item:y}=(0,w.H)("settings","user-preferences"),[j,v]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[S,L]=(0,a.useState)(null),[I,A]=(0,a.useState)(null),[E,T]=(0,a.useState)(!1),[M,D]=(0,a.useState)(null),[P,B]=(0,a.useState)(null),[R,O]=(0,a.useState)(!1),[F,_]=(0,a.useState)(!1),[U,z]=(0,a.useState)(null),[W,H]=(0,a.useState)(null),[V,q]=(0,a.useState)(!1),[Y,J]=(0,a.useState)(null),[K,X]=(0,a.useState)(null),[Q,Z]=(0,a.useState)(!1),[$,ee]=(0,a.useState)(null),[eh,em]=(0,a.useState)(null),[ex,ep]=(0,a.useState)(!1),[eg,ef]=(0,a.useState)(null),eb=(0,a.useRef)(null),[ey,ew]=(0,a.useState)(null),ej=(0,a.useRef)(null),ev=(0,a.useRef)(null),[ek,eN]=(0,a.useState)(0),eC=(0,a.useRef)(null),[eS,eL]=(0,a.useState)(null),[eI,eA]=(0,a.useState)(""),eE=(0,a.useRef)(null),eT=(0,a.useRef)(!1),[eM,eD]=(0,a.useState)(!1),[eP,eB]=(0,a.useState)(!1),eR=[{id:"photos",label:"Pictures & Notes",icon:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{id:"specifics",label:"Item Specifics",icon:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})},{id:"details",label:"Listing Details",icon:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{id:"shipping",label:"Shipping",icon:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"})})},{id:"pricing",label:"Pricing & Format",icon:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}],eO=async function(e,t,s,n){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};t(!0),s(null);try{let t=(0,r._9)().access_token,s=await fetch(e,{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("Failed to fetch: ".concat(s.status));let l=await s.json();n(l)}catch(e){console.error("Fetch error:",e),s(e.message||"Failed to load data. Please try again."),l()}finally{t(!1)}},eF=async e=>{await eO("/api/ebay/categories/aspects?categoryId=".concat(e),T,D,e=>A(e.aspects||[]),()=>A([]))},e_=async e=>{await eO("/api/ebay/categories/conditions?categoryId=".concat(e),_,z,e=>{B(e.conditions||[]),O(e.conditionRequired||!1)},()=>{B([]),O(!1)})},eU=async()=>{await eO("/api/ebay/policies/shipping",q,J,e=>H(e.policies||[]),()=>H([]))},ez=async()=>{await eO("/api/ebay/policies/payment",Z,ee,e=>X(e.policies||[]),()=>X([]))},eW=async()=>{await eO("/api/ebay/policies/return",ep,ef,e=>em(e.policies||[]),()=>em([]))},eH=async()=>{eB(!0);try{let e=(0,r._9)().access_token;await fetch("/api/ebay/policies/create-defaults",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),eU(),ez(),eW()}catch(e){console.error("Failed to create preset policies:",e)}finally{eB(!1)}};if((0,a.useEffect)(()=>{ev.current&&(null==p?void 0:p.pictures)&&(0,ed.M)(ev.current,void 0,{isPressHoldMode:!0,allowDragScroll:!1})},[null==p?void 0:p.pictures]),(0,a.useEffect)(()=>{eU(),ez(),eW()},[]),(0,a.useEffect)(()=>{var e;(null==p||null==(e=p.category)?void 0:e.id)?(eF(p.category.id),e_(p.category.id)):(A(null),T(!1),B(null),_(!1))},[null==p||null==(e=p.category)?void 0:e.id]),(0,a.useEffect)(()=>{eb.current&&document.activeElement!==eb.current&&p&&eb.current.innerHTML!==p.description&&(eb.current.innerHTML=p.description||"")},[null==p?void 0:p.description,h]),(0,a.useEffect)(()=>{let e=()=>{eC.current&&eN(Math.round(eC.current.scrollLeft/eC.current.offsetWidth))},t=eC.current;return t&&t.addEventListener("scrollend",e),()=>{t&&t.removeEventListener("scrollend",e)}},[]),(0,a.useEffect)(()=>{(null==p?void 0:p.status)==="processing"&&x(null)},[null==p?void 0:p.status,x]),(0,a.useEffect)(()=>{p&&!f&&"error"===p.status&&(console.log("[Draft Editor] Clearing error status"),eV({status:"idle",processingType:null,processingError:""}))},[null==p?void 0:p.status,f,h]),(0,a.useEffect)(()=>{if(eT.current){eT.current=!1;return}(null==p?void 0:p.price)!==void 0&&(null==p?void 0:p.price)!==null&&(null==p?void 0:p.price)!==""?eA((function(e){let t=parseFloat(e)||0;return t+eu(t)})(parseFloat(p.price)||0).toFixed(2)):eA("")},[null==p?void 0:p.price,h]),(0,a.useEffect)(()=>()=>{eE.current&&clearTimeout(eE.current)},[]),f)return(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)("div",{className:"text-center text-slate-400",children:(0,n.jsx)("p",{className:"text-lg",children:"Loading draft..."})})});if(b||!p)return(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsxs)("div",{className:"text-center text-slate-400",children:[(0,n.jsx)("p",{className:"text-lg",children:"Draft not found"}),b&&(0,n.jsx)("p",{className:"text-sm text-red-400",children:b})]})});let eV=e=>{g({...p,...e})},eq=async e=>{let t=Array.from(e.target.files||[]);if(0===t.length)return;let s=p.pictures?p.pictures.length:0;if(s+t.length>24)return void eL("Can only add ".concat(24-s," more photos (24 max total)"));eD(!0);try{let e=[];for(let s of t){if(!s.type.startsWith("image/"))continue;let t=new FileReader,n=await new Promise(e=>{t.onload=()=>e(t.result),t.readAsDataURL(s)}),l=await fetch("/api/images",{method:"POST",headers:{Authorization:"Bearer ".concat((0,r._9)().access_token),"Content-Type":"application/json"},body:JSON.stringify({image:n})});if(!l.ok)throw Error("Failed to upload image: ".concat(l.status));let a=await l.json();e.push(a.hash)}if(e.length>0){let t=[...p.pictures||[],...e];eV({pictures:t})}}catch(e){console.error("Error uploading files:",e),eL("Failed to upload images. Please try again.")}finally{eD(!1)}ej.current&&(ej.current.value="")},eG=async()=>{if(p.pictures&&0!==p.pictures.length)try{let e=(0,r._9)().username,t=new Date,s=t.getFullYear().toString()+(t.getMonth()+1).toString().padStart(2,"0")+t.getDate().toString().padStart(2,"0")+"-"+t.getHours().toString().padStart(2,"0")+t.getMinutes().toString().padStart(2,"0")+t.getSeconds().toString().padStart(2,"0");for(let t=0;t<p.pictures.length;t++){let n=p.pictures[t],l="/images/".concat(e,"/").concat(n,".jpg"),a=await fetch(l);if(!a.ok){console.error("Failed to download image ".concat(t+1));continue}let r=await a.blob(),i=window.URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download="".concat(s,"-").concat(t+1,".jpg"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i)}}catch(e){console.error("Error downloading images:",e),eL("Failed to download images. Please try again.")}},eY=e=>{C(e)},eJ=e=>{let{hash:t,rotation:s}=function(e){if(!e)return{hash:null,rotation:0};let t=String(e).trim(),s=t.lastIndexOf("-");if(-1===s)return{hash:t,rotation:0};let n=t.substring(0,s),l=t.substring(s+1),a=parseInt(l,10);return isNaN(a)||![0,90,180,270].includes(a)||l!==String(a)?{hash:t,rotation:0}:{hash:n,rotation:a}}(p.pictures[e]),n=function(e,t){let s=(t%360+360)%360;return 0===s?e:[90,180,270].includes(s)?"".concat(e,"-").concat(s):(console.warn("Invalid rotation angle ".concat(t,", normalized to ").concat(s,". Using 0 instead.")),e)}(t,(s+90)%360),l=[...p.pictures];l[e]=n,eV({pictures:l})},eK=e=>{ew(e)},eX=e=>{e.preventDefault()},eQ=e=>{if(null===ey||ey===e)return void ew(null);let t=[...p.pictures],[s]=t.splice(ey,1);t.splice(e,0,s),eV({pictures:t}),ew(null)};return(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[(0,n.jsx)(er,{sections:eR,activeSection:ek,onSectionClick:e=>{if(eN(e),eC.current){let t=e*eC.current.offsetWidth,s=window.matchMedia("(max-width: 768px)").matches;eC.current.scrollTo({left:t,behavior:s?"smooth":"auto"})}}}),(0,n.jsxs)("div",{ref:eC,style:{scrollbarWidth:"none",msOverflowStyle:"none",scrollPaddingLeft:"1rem"},className:"jsx-aaeb17c7ce19df29 flex-1 overflow-x-auto snap-x snap-mandatory scroll-smooth md:scroll-auto",children:[(0,n.jsx)(et(),{id:"aaeb17c7ce19df29",children:"div.jsx-aaeb17c7ce19df29::-webkit-scrollbar{display:none}"}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 flex h-full px-4 pt-2 gap-4",children:[(0,n.jsx)("div",{style:{width:"calc(100vw - 2rem)"},className:"jsx-aaeb17c7ce19df29 snap-start flex-shrink-0 overflow-y-auto custom-scrollbar h-full",children:(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 w-full bg-slate-800 rounded-md shadow-md px-4 pt-4 pb-4 min-h-full",children:[(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Pictures ",p.pictures&&p.pictures.length>0&&(0,n.jsxs)("span",{className:"jsx-aaeb17c7ce19df29 text-slate-400 font-normal",children:["(",p.pictures.length,"/24)"]})]}),p.pictures&&p.pictures.length>0?(0,n.jsxs)("div",{ref:ev,className:"jsx-aaeb17c7ce19df29 flex flex-col sm:flex-row gap-4",children:[(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 w-full sm:w-72 shrink-0 flex items-center justify-center",children:(0,n.jsxs)("div",{onDragOver:eX,onDrop:()=>eQ(0),className:"jsx-aaeb17c7ce19df29 relative group w-full max-w-sm sm:max-w-none",children:[(0,n.jsx)("div",{draggable:!0,onDragStart:()=>eK(0),onContextMenu:e=>e.preventDefault(),"data-photo-index":0,style:{WebkitTouchCallout:"none",WebkitUserSelect:"none"},className:"jsx-aaeb17c7ce19df29 "+"aspect-square cursor-move ".concat(0===ey?"opacity-50":""),children:(0,n.jsx)(en,{hash:p.pictures[0],index:0,onDelete:()=>eY(0),onRotate:()=>eJ(0),onView:L,isMain:!0})}),(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 absolute top-1 left-1 bg-black/50 text-white text-xs px-1.5 py-0.5 rounded pointer-events-none",children:"1"})]},p.pictures[0])}),p.pictures.length>1&&(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 flex-1 min-w-0",children:(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 grid grid-cols-[repeat(auto-fill,6rem)] gap-2 auto-rows-[6rem] content-start justify-center sm:justify-start",children:p.pictures.slice(1).map((e,t)=>{let s=t+1;return(0,n.jsxs)("div",{draggable:!0,onDragStart:()=>eK(s),onDragOver:eX,onDrop:()=>eQ(s),onContextMenu:e=>e.preventDefault(),"data-photo-index":s,style:{WebkitTouchCallout:"none",WebkitUserSelect:"none"},className:"jsx-aaeb17c7ce19df29 "+"relative cursor-move ".concat(ey===s?"opacity-50":""),children:[(0,n.jsx)(en,{hash:e,index:s,onDelete:()=>eY(s),onRotate:()=>eJ(s),onView:L}),(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 absolute top-1 left-1 bg-black/50 text-white text-xs px-1.5 py-0.5 rounded pointer-events-none",children:s+1})]},e)})})})]}):(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 bg-slate-800 rounded-lg p-8 text-center text-slate-400",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-aaeb17c7ce19df29 mx-auto mb-2 text-slate-600",children:[(0,n.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("polyline",{points:"21 15 16 10 5 21",className:"jsx-aaeb17c7ce19df29"})]}),(0,n.jsx)("p",{className:"jsx-aaeb17c7ce19df29 text-sm",children:"No photos yet"})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 flex gap-2 mt-4",children:[(0,n.jsxs)("button",{onClick:()=>v(!0),disabled:p.pictures&&p.pictures.length>=24,className:"jsx-aaeb17c7ce19df29 flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg shadow transition-colors flex items-center justify-center gap-2",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-aaeb17c7ce19df29",children:[(0,n.jsx)("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("circle",{cx:"12",cy:"13",r:"3",className:"jsx-aaeb17c7ce19df29"})]}),(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 hidden sm:inline",children:"Camera"})]}),(0,n.jsx)("button",{onClick:()=>{var e;return null==(e=ej.current)?void 0:e.click()},disabled:p.pictures&&p.pictures.length>=24||eM,className:"jsx-aaeb17c7ce19df29 flex-1 bg-green-600 hover:bg-green-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg shadow transition-colors flex items-center justify-center gap-2",children:eM?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"jsx-aaeb17c7ce19df29 animate-spin h-5 w-5",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"jsx-aaeb17c7ce19df29 opacity-25"}),(0,n.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"jsx-aaeb17c7ce19df29 opacity-75"})]}),(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 hidden sm:inline",children:"Uploading..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-aaeb17c7ce19df29",children:[(0,n.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("polyline",{points:"17 8 12 3 7 8",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15",className:"jsx-aaeb17c7ce19df29"})]}),(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 hidden sm:inline",children:"Upload"})]})}),(0,n.jsxs)("button",{onClick:eG,disabled:!p.pictures||0===p.pictures.length,className:"jsx-aaeb17c7ce19df29 flex-1 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg shadow transition-colors flex items-center justify-center gap-2",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-aaeb17c7ce19df29",children:[(0,n.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("polyline",{points:"7 10 12 15 17 10",className:"jsx-aaeb17c7ce19df29"}),(0,n.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3",className:"jsx-aaeb17c7ce19df29"})]}),(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 hidden sm:inline",children:"Download"})]})]}),(0,n.jsx)("input",{ref:ej,type:"file",accept:"image/*",multiple:!0,onChange:eq,className:"jsx-aaeb17c7ce19df29 hidden"})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsx)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:"Notes"}),(0,n.jsx)(ec,{value:p.notes,onChange:e=>eV({notes:e.target.value}),placeholder:"Enter notes...",maxLength:1e4,className:"w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 min-h-[76px]"}),(0,n.jsx)("p",{className:"jsx-aaeb17c7ce19df29 mt-1 text-xs text-slate-400",children:"Notes for your reference only - not included in the listing. These will also be shared with AI Assist, so you can include any custom instructions."})]}),p.log&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-0",children:[(0,n.jsx)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:"Processing Log"}),(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-3",children:(0,n.jsx)("pre",{className:"jsx-aaeb17c7ce19df29 whitespace-pre-wrap break-words text-sm font-mono text-slate-300",children:p.log})})]})]})}),(0,n.jsx)("div",{style:{width:"calc(100vw - 2rem)"},className:"jsx-aaeb17c7ce19df29 snap-start flex-shrink-0 overflow-y-auto custom-scrollbar h-full",children:(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 w-full bg-slate-800 rounded-md shadow-md px-4 pt-4 pb-4 min-h-full",children:[(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Category",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)(el,{value:p.category,onChange:e=>eV({category:e})})]}),p.category?(0,n.jsx)(eo,{loading:E,error:M,onRetry:()=>eF(p.category.id),loadingMessage:"Loading item specifics...",children:I&&I.length>0&&(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 mb-0",children:I.map(e=>{var t;return(0,n.jsx)(ea,{aspect:e,value:null==(t=p.aspects)?void 0:t[e.localizedAspectName],onChange:t=>{var s;return s=e.localizedAspectName,void eV({aspects:{...p.aspects||{},[s]:t}})}},e.localizedAspectName)})})}):(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 bg-slate-700/50 rounded-lg p-4 text-center text-slate-400 text-sm",children:"Select a category to see item specifics"})]})}),(0,n.jsx)("div",{style:{width:"calc(100vw - 2rem)"},className:"jsx-aaeb17c7ce19df29 snap-start flex-shrink-0 overflow-y-auto custom-scrollbar h-full",children:(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 w-full bg-slate-800 rounded-md shadow-md px-4 pt-4 pb-4 min-h-full",children:[p.category&&(0,n.jsx)(eo,{loading:F,error:U,onRetry:()=>e_(p.category.id),loadingMessage:"Loading condition options...",children:P&&P.length>0&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Condition",R&&(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)(G,{options:P.map(e=>({id:e.id,label:e.description})),value:(null==(t=p.condition)?void 0:t.description)||null,onChange:e=>{eV({condition:P.find(t=>t.description===e)||null,conditionDescription:""})},isMulti:!1,allowCustom:!1,placeholder:"Search or select condition..."})]})}),p.condition&&!["1000","1500","1750"].includes(p.condition.id)&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Condition Description",(0,n.jsxs)("span",{className:"jsx-aaeb17c7ce19df29 "+"text-xs ml-2 ".concat(((null==(s=p.conditionDescription)?void 0:s.length)||0)>1e3?"text-red-400 font-semibold":"text-slate-400"),children:["(",(null==(l=p.conditionDescription)?void 0:l.length)||0,"/1000)"]})]}),(0,n.jsx)(ec,{value:p.conditionDescription,onChange:e=>eV({conditionDescription:e.target.value}),placeholder:"Describe the item's condition...",maxLength:1e3,className:"w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Title",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"}),(0,n.jsxs)("span",{className:"jsx-aaeb17c7ce19df29 "+"text-xs ml-2 ".concat(p.title.length>80?"text-red-400 font-semibold":"text-slate-400"),children:["(",p.title.length,"/80)"]})]}),(0,n.jsx)("input",{type:"text",value:p.title,onChange:e=>eV({title:e.target.value}),placeholder:"Enter listing title...",className:"jsx-aaeb17c7ce19df29 w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Description",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 relative",children:(0,n.jsx)("div",{ref:eb,contentEditable:!0,suppressContentEditableWarning:!0,onInput:e=>{eV({description:e.currentTarget.innerHTML})},"data-placeholder":"Describe your item...",style:{wordBreak:"break-word"},className:"jsx-aaeb17c7ce19df29 w-full min-h-[200px] bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 empty:before:content-[attr(data-placeholder)] empty:before:text-slate-500 [&_p]:my-3 [&_hr]:my-3"})}),(0,n.jsx)("p",{className:"jsx-aaeb17c7ce19df29 mt-1 text-xs text-slate-400",children:"Rich text supported - select text to bold, italic, etc. HTML will be preserved."})]})]})}),(0,n.jsx)("div",{style:{width:"calc(100vw - 2rem)"},className:"jsx-aaeb17c7ce19df29 snap-start flex-shrink-0 overflow-y-auto custom-scrollbar h-full",children:(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 w-full bg-slate-800 rounded-md shadow-md px-4 pt-4 pb-4 min-h-full",children:[(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsx)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:"Package Weight"}),(0,n.jsx)(G,{options:[{id:"1",label:"Up to 1kg"},{id:"2",label:"Up to 2kg"},{id:"5",label:"Up to 5kg"},{id:"10",label:"Up to 10kg"},{id:"20",label:"Up to 20kg"},{id:"30",label:"Up to 30kg"}],value:p.packageWeight?"Up to ".concat(p.packageWeight,"kg"):null,onChange:e=>{eV({packageWeight:{"Up to 1kg":"1","Up to 2kg":"2","Up to 5kg":"5","Up to 10kg":"10","Up to 20kg":"20","Up to 30kg":"30"}[e]||null})},isMulti:!1,allowCustom:!1,placeholder:"Select weight..."})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsx)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:"Package Size"}),(0,n.jsx)(G,{options:[{id:"LARGE_LETTER",label:"Large Letter (max 35x25x2.5cm)"},{id:"SMALL_PARCEL",label:"Small Parcel (max 45x35x16cm)"},{id:"MEDIUM_PARCEL",label:"Medium Parcel (max 61x46x46cm)"},{id:"LARGE_PARCEL",label:"Bulky parcel (max 120x80x80cm)"}],value:p.packageSize?"LARGE_LETTER"===p.packageSize?"Large Letter (max 35x25x2.5cm)":"SMALL_PARCEL"===p.packageSize?"Small Parcel (max 45x35x16cm)":"MEDIUM_PARCEL"===p.packageSize?"Medium Parcel (max 61x46x46cm)":"Bulky parcel (max 120x80x80cm)":null,onChange:e=>{eV({packageSize:{"Large Letter (max 35x25x2.5cm)":"LARGE_LETTER","Small Parcel (max 45x35x16cm)":"SMALL_PARCEL","Medium Parcel (max 61x46x46cm)":"MEDIUM_PARCEL","Bulky parcel (max 120x80x80cm)":"LARGE_PARCEL"}[e]||null})},isMulti:!1,allowCustom:!1,placeholder:"Select size..."})]}),(0,n.jsx)(eo,{loading:V,error:Y,onRetry:eU,onCreateDefaults:eP?null:eH,creatingDefaults:eP,loadingMessage:"Loading shipping policies...",children:W&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Shipping Policy",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)(G,{options:W.filter(e=>!e.name.toLowerCase().includes("deprecated")).map(e=>({id:e.id,label:e.name})),value:(null==(i=p.shippingPolicy)?void 0:i.name)||null,onChange:e=>{eV({shippingPolicy:W.find(t=>t.name===e)||null})},isMulti:!1,allowCustom:!1,placeholder:"Search or select shipping policy..."})]})}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Post Code",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)("input",{type:"text",value:p.postcode||"",onChange:e=>eV({postcode:e.target.value.toUpperCase()}),placeholder:"SW1A 1AA",maxLength:8,className:"jsx-aaeb17c7ce19df29 w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})]})}),(0,n.jsx)("div",{style:{width:"calc(100vw - 2rem)"},className:"jsx-aaeb17c7ce19df29 snap-start flex-shrink-0 overflow-y-auto custom-scrollbar h-full",children:(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 w-full bg-slate-800 rounded-md shadow-md px-4 pt-4 pb-4 min-h-full",children:[(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Format",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)(G,{options:[{id:"BuyItNow",label:"Buy It Now"},{id:"Auction",label:"Auction"}],value:"BuyItNow"===p.format?"Buy It Now":"Auction",onChange:e=>{eV({format:"Buy It Now"===e?"BuyItNow":"Auction"})},isMulti:!1,allowCustom:!1,placeholder:"Select format..."})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Price (GBP)",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)("input",{type:"number",step:"0.01",min:"0.49",value:p.price||"",onChange:e=>eV({price:e.target.value}),placeholder:"0.49",style:{MozAppearance:"textfield"},className:"jsx-aaeb17c7ce19df29 w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),(0,n.jsx)("p",{className:"jsx-aaeb17c7ce19df29 mt-1 text-xs text-slate-400",children:(null==y||null==(o=y.defaults)?void 0:o.accountType)==="BUSINESS"?"Your listing price (minimum \xa30.49)":"Your price before buyer's fee (minimum \xa30.49)"})]}),(null==y||null==(c=y.defaults)?void 0:c.accountType)!=="BUSINESS"&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsx)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:"Price with Buyer's Fee (GBP)"}),(0,n.jsx)("input",{type:"number",step:"0.01",min:"0.50",value:eI,onChange:e=>{let t=e.target.value;eA(t),eE.current&&clearTimeout(eE.current),eE.current=setTimeout(()=>{let e=(function(e){let t=parseFloat(e)||0;return Math.round(100*(t<=21.5?(t-.1)/1.07:t<=312.7?(t-.7)/1.04:t<=4086.7?(t-6.7)/1.02:t-86.7))/100})(parseFloat(t)||0).toFixed(2);eT.current=!0,eV({price:e})},500)},placeholder:"0.00",style:{MozAppearance:"textfield"},className:"jsx-aaeb17c7ce19df29 w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),(0,n.jsxs)("p",{className:"jsx-aaeb17c7ce19df29 mt-1 text-xs text-slate-400",children:["Final price the buyer will pay (\xa3",eu(parseFloat(p.price)||0).toFixed(2)," buyer's fee)"]})]}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Quantity",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)("input",{type:"number",min:"1",value:p.quantity||"",onChange:e=>eV({quantity:parseInt(e.target.value)||1}),placeholder:"1",style:{MozAppearance:"textfield"},className:"jsx-aaeb17c7ce19df29 w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),(0,n.jsx)(eo,{loading:Q,error:$,onRetry:ez,onCreateDefaults:eP?null:eH,creatingDefaults:eP,loadingMessage:"Loading payment policies...",children:K&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Payment Policy",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)(G,{options:K.map(e=>({id:e.id,label:e.name})),value:(null==(d=p.paymentPolicy)?void 0:d.name)||null,onChange:e=>{eV({paymentPolicy:K.find(t=>t.name===e)||null})},isMulti:!1,allowCustom:!1,placeholder:"Search or select payment policy..."})]})}),(0,n.jsx)(eo,{loading:ex,error:eg,onRetry:eW,onCreateDefaults:eP?null:eH,creatingDefaults:eP,loadingMessage:"Loading return policies...",children:eh&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:["Return Policy",(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-red-400 ml-1",children:"*"})]}),(0,n.jsx)(G,{options:eh.map(e=>({id:e.id,label:e.name})),value:(null==(u=p.returnPolicy)?void 0:u.name)||null,onChange:e=>{eV({returnPolicy:eh.find(t=>t.name===e)||null})},isMulti:!1,allowCustom:!1,placeholder:"Search or select return policy..."})]})}),(0,n.jsx)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:p.offersEnabled||!1,onChange:e=>eV({offersEnabled:e.target.checked}),className:"jsx-aaeb17c7ce19df29 w-5 h-5 text-blue-500 bg-slate-700 border-slate-600 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-slate-300 text-sm font-medium",children:"Allow Offers"})]})}),(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 mb-6",children:[(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 flex items-center gap-3 mb-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:p.promotionEnabled||!1,onChange:e=>eV({promotionEnabled:e.target.checked}),className:"jsx-aaeb17c7ce19df29 w-5 h-5 text-blue-500 bg-slate-700 border-slate-600 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),(0,n.jsx)("span",{className:"jsx-aaeb17c7ce19df29 text-slate-300 text-sm font-medium",children:"Promoted Listing"})]}),p.promotionEnabled&&(0,n.jsxs)("div",{className:"jsx-aaeb17c7ce19df29 ml-8",children:[(0,n.jsx)("label",{className:"jsx-aaeb17c7ce19df29 block text-slate-300 text-sm font-medium mb-2",children:"Ad Rate (%)"}),(0,n.jsx)("input",{type:"number",step:"0.1",min:"0",max:"20",value:p.promotionPercentage||"",onChange:e=>eV({promotionPercentage:parseFloat(e.target.value)||2}),placeholder:"2.0",className:"jsx-aaeb17c7ce19df29 w-32 bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})]})]})}),(0,n.jsx)("div",{style:{width:"1rem"},className:"jsx-aaeb17c7ce19df29 flex-shrink-0"})]})]}),j&&(0,n.jsx)(es,{onClose:()=>v(!1),onCapture:e=>{eV({pictures:[...p.pictures||[],...e]}),v(!1)},draftId:h,currentPhotoCount:p.pictures?p.pictures.length:0}),(0,n.jsx)(N.A,{isOpen:null!==k,onClose:()=>C(null),onConfirm:()=>{null!==k&&(eV({pictures:p.pictures.filter((e,t)=>t!==k)}),C(null))},title:"Delete Photo",message:"Are you sure you want to delete this photo?",confirmText:"Delete",type:"confirm"}),(0,n.jsx)(ei,{imageUrl:S,onClose:()=>L(null)}),(0,n.jsx)(N.A,{isOpen:!!eS,onClose:()=>{eL(null)},onConfirm:()=>{eL(null)},title:"Error",message:eS||"",confirmText:"OK",type:"alert"})]})}function em(){let{activeDraftId:e}=m();return(0,n.jsx)("div",{className:"h-full flex flex-col",children:e?(0,n.jsx)(eh,{}):(0,n.jsx)($,{})})}function ex(){return(0,n.jsx)("div",{className:"flex items-center sm:gap-2 flex-wrap sm:flex-nowrap",children:(0,n.jsx)("div",{className:"w-full sm:w-auto mb-2 sm:mb-0 sm:mr-4",children:(0,n.jsx)(p,{})})})}function ep(){var e,t,s,l,i,o,c,d,u,h,m,x,p,g,f,b,y,j;let{item:v,setItem:k,isLoading:C}=(0,w.H)("settings","user-preferences"),[S,L]=(0,a.useState)(null),[I,A]=(0,a.useState)(!1),[E,T]=(0,a.useState)(null),[M,D]=(0,a.useState)(null),[P,B]=(0,a.useState)(!1),[R,O]=(0,a.useState)(null),[F,_]=(0,a.useState)(null),[U,z]=(0,a.useState)(!1),[W,H]=(0,a.useState)(null),[V,q]=(0,a.useState)(!1),[J,K]=(0,a.useState)(null),[X,Q]=(0,a.useState)(null),[Z,$]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!C){if(null===v)k({defaults:{shippingPolicy:null,paymentPolicy:null,returnPolicy:null,postcode:"",offersEnabled:!0,promotionEnabled:!1,promotionPercentage:2,packageWeight:"2",packageSize:"SMALL_PARCEL",accountType:"INDIVIDUAL"},categoryInstructions:[],taskInstructions:{listingStyle:{preset:"balanced"},pricingStrategy:{preset:"match-market"}},generalInstructions:""});else if(v.defaults&&(void 0===v.defaults.packageWeight||void 0===v.defaults.packageSize||void 0===v.defaults.postcode||void 0===v.defaults.accountType||void 0!==v.defaults.location||void 0===v.generalInstructions)){let e={...v.defaults,packageWeight:v.defaults.packageWeight||"2",packageSize:v.defaults.packageSize||"SMALL_PARCEL",offersEnabled:void 0===v.defaults.offersEnabled||v.defaults.offersEnabled,promotionEnabled:void 0!==v.defaults.promotionEnabled&&v.defaults.promotionEnabled,promotionPercentage:v.defaults.promotionPercentage||2,postcode:v.defaults.postcode||"",accountType:v.defaults.accountType||"INDIVIDUAL"};delete e.location,k({...v,defaults:e,generalInstructions:v.generalInstructions||""})}}},[v,C,k]);let es=async function(e,t,s,n){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};t(!0),s(null);try{let t=(0,r._9)().access_token,s=await fetch(e,{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("Failed to fetch: ".concat(s.status));let l=await s.json();n(l)}catch(e){console.error("Fetch error:",e),s(e.message||"Failed to load data. Please try again."),l()}finally{t(!1)}},en=(0,a.useCallback)(async()=>{await es("/api/ebay/policies/shipping",A,T,e=>L(e.policies||[]),()=>L([]))},[]),ea=(0,a.useCallback)(async()=>{await es("/api/ebay/policies/payment",B,O,e=>D(e.policies||[]),()=>D([]))},[]),er=(0,a.useCallback)(async()=>{await es("/api/ebay/policies/return",z,H,e=>_(e.policies||[]),()=>_([]))},[]);(0,a.useEffect)(()=>{en(),ea(),er()},[en,ea,er]);let ei=(null==v||null==(t=v.taskInstructions)||null==(e=t.listingStyle)?void 0:e.preset)==="custom"?(null==v||null==(l=v.taskInstructions)||null==(s=l.listingStyle)?void 0:s.customText)||"":(null==(i=Y.listingStyle.find(e=>{var t,s;return e.id===(null==v||null==(s=v.taskInstructions)||null==(t=s.listingStyle)?void 0:t.preset)}))?void 0:i.instructions)||"",ed=(null==v||null==(c=v.taskInstructions)||null==(o=c.pricingStrategy)?void 0:o.preset)==="custom"?(null==v||null==(u=v.taskInstructions)||null==(d=u.pricingStrategy)?void 0:d.customText)||"":(null==(h=Y.pricingStrategy.find(e=>{var t,s;return e.id===(null==v||null==(s=v.taskInstructions)||null==(t=s.pricingStrategy)?void 0:t.preset)}))?void 0:h.instructions)||"",eu=e=>{k({...v,...e})},eh=(e,t)=>{eu({defaults:{...v.defaults,[e]:t}})},em=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";eu({taskInstructions:{...v.taskInstructions,[e]:"custom"===t?{preset:"custom",customText:s}:{preset:t}}})},ex=async()=>{q(!0);try{let e=(0,r._9)();if(!e||!e.access_token)return;let t=e.access_token;await fetch("/api/ebay/policies/create-defaults",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}),en(),ea(),er()}catch(e){console.error("Failed to create preset policies:",e)}finally{q(!1)}},ep=()=>{let e=(0,r._9)();if(null==e?void 0:e.username){let t=(0,r.Px)();t[e.username]=e,(0,r.H1)(t)}},eg=()=>{$(!0)},ef=()=>{ep(),window.location.href="/api/auth/ebay/authorize?forceLogin=true"};return C||!v?(0,n.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-center text-slate-400",children:(0,n.jsx)("p",{className:"text-lg",children:"Loading settings..."})})}):(0,n.jsxs)("div",{className:"h-full overflow-y-auto custom-scrollbar",children:[(0,n.jsxs)("div",{className:"px-4",children:[(0,n.jsx)(()=>{let e=(()=>{let e=(0,r.Px)(),t=(0,r._9)();return(null==t?void 0:t.username)&&(e[t.username]=t),e})(),t=(0,r._9)(),s=null==t?void 0:t.username,l=Object.values(e);return(0,n.jsxs)("div",{className:"bg-slate-800 rounded-md shadow-md p-6 mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-slate-100 mb-6",children:"Account Management"}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Active Account"}),(0,n.jsx)(G,{options:l.map(e=>({id:e.username,label:e.username})),value:s,onChange:e=>(e=>{let t=(0,r._9)();e!==(null==t?void 0:t.username)&&et(e)})(e),isMulti:!1,allowCustom:!1,placeholder:"Select account..."})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Account Type"}),(0,n.jsx)(G,{options:[{id:"INDIVIDUAL",label:"Personal"},{id:"BUSINESS",label:"Business"}],value:"BUSINESS"===v.defaults.accountType?"Business":"Personal",onChange:e=>{eh("accountType","Business"===e?"BUSINESS":"INDIVIDUAL")},isMulti:!1,allowCustom:!1,placeholder:"Select account type..."})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{onClick:eg,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Logout"}),(0,n.jsx)("button",{onClick:ef,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"Add Account"})]})]})},{}),(0,n.jsxs)("div",{className:"bg-slate-800 rounded-md shadow-md p-6 mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-slate-100 mb-6",children:"Listing Defaults"}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-2",children:"Policies"}),(0,n.jsxs)("p",{className:"text-sm text-slate-400 mb-4",children:["Business policies are required to publish listings. They can be managed in ",(0,n.jsx)("a",{href:"https://www.ebay.co.uk/bp/manage",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"eBay Business Policies"}),"."]}),(0,n.jsx)(eo,{loading:P,error:R,onRetry:ea,onCreateDefaults:V?null:ex,creatingDefaults:V,loadingMessage:"Loading payment policies...",children:M&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Payment Policy"}),(0,n.jsx)(G,{options:M.map(e=>({id:e.id,label:e.name})),value:(null==(m=v.defaults.paymentPolicy)?void 0:m.name)||null,onChange:e=>{eh("paymentPolicy",M.find(t=>t.name===e)||null)},isMulti:!1,allowCustom:!1,placeholder:"Select default payment policy..."})]})}),(0,n.jsx)(eo,{loading:U,error:W,onRetry:er,onCreateDefaults:V?null:ex,creatingDefaults:V,loadingMessage:"Loading return policies...",children:F&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Return Policy"}),(0,n.jsx)(G,{options:F.map(e=>({id:e.id,label:e.name})),value:(null==(x=v.defaults.returnPolicy)?void 0:x.name)||null,onChange:e=>{eh("returnPolicy",F.find(t=>t.name===e)||null)},isMulti:!1,allowCustom:!1,placeholder:"Select default return policy..."})]})}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-2 mt-8",children:"Shipping & Packaging"}),(0,n.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Choose your most commonly used options to save time when creating listings."}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Post Code"}),(0,n.jsx)("input",{type:"text",value:v.defaults.postcode||"",onChange:e=>eh("postcode",e.target.value.toUpperCase()),placeholder:"SW1A 1AA",maxLength:8,className:"w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),(0,n.jsx)(eo,{loading:I,error:E,onRetry:en,onCreateDefaults:V?null:ex,creatingDefaults:V,loadingMessage:"Loading shipping policies...",children:S&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Shipping Policy"}),(0,n.jsx)(G,{options:S.map(e=>({id:e.id,label:e.name})),value:(null==(p=v.defaults.shippingPolicy)?void 0:p.name)||null,onChange:e=>{eh("shippingPolicy",S.find(t=>t.name===e)||null)},isMulti:!1,allowCustom:!1,placeholder:"Select default shipping policy..."})]})}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Package Weight"}),(0,n.jsx)(G,{options:[{id:"1",label:"Up to 1kg"},{id:"2",label:"Up to 2kg"},{id:"5",label:"Up to 5kg"},{id:"10",label:"Up to 10kg"},{id:"20",label:"Up to 20kg"},{id:"30",label:"Up to 30kg"}],value:v.defaults.packageWeight?"Up to ".concat(v.defaults.packageWeight,"kg"):null,onChange:e=>{eh("packageWeight",{"Up to 1kg":"1","Up to 2kg":"2","Up to 5kg":"5","Up to 10kg":"10","Up to 20kg":"20","Up to 30kg":"30"}[e]||null)},isMulti:!1,allowCustom:!1,placeholder:"Select default weight..."})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Package Size"}),(0,n.jsx)(G,{options:[{id:"LARGE_LETTER",label:"Large Letter (max 35x25x2.5cm)"},{id:"SMALL_PARCEL",label:"Small Parcel (max 45x35x16cm)"},{id:"MEDIUM_PARCEL",label:"Medium Parcel (max 61x46x46cm)"},{id:"LARGE_PARCEL",label:"Bulky parcel (max 120x80x80cm)"}],value:v.defaults.packageSize?"LARGE_LETTER"===v.defaults.packageSize?"Large Letter (max 35x25x2.5cm)":"SMALL_PARCEL"===v.defaults.packageSize?"Small Parcel (max 45x35x16cm)":"MEDIUM_PARCEL"===v.defaults.packageSize?"Medium Parcel (max 61x46x46cm)":"Bulky parcel (max 120x80x80cm)":null,onChange:e=>{eh("packageSize",{"Large Letter (max 35x25x2.5cm)":"LARGE_LETTER","Small Parcel (max 45x35x16cm)":"SMALL_PARCEL","Medium Parcel (max 61x46x46cm)":"MEDIUM_PARCEL","Bulky parcel (max 120x80x80cm)":"LARGE_PARCEL"}[e]||null)},isMulti:!1,allowCustom:!1,placeholder:"Select default size..."})]}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-3 mt-8",children:"Listing Options"}),(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:v.defaults.offersEnabled||!1,onChange:e=>eh("offersEnabled",e.target.checked),className:"w-5 h-5 text-blue-500 bg-slate-700 border-slate-600 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),(0,n.jsx)("span",{className:"text-slate-300 text-sm font-medium",children:"Allow Offers"})]})}),(0,n.jsxs)("div",{className:"mb-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:v.defaults.promotionEnabled||!1,onChange:e=>eh("promotionEnabled",e.target.checked),className:"w-5 h-5 text-blue-500 bg-slate-700 border-slate-600 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),(0,n.jsx)("span",{className:"text-slate-300 text-sm font-medium",children:"Promoted Listing"})]}),v.defaults.promotionEnabled&&(0,n.jsxs)("div",{className:"ml-8",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Ad Rate (%)"}),(0,n.jsx)("input",{type:"number",step:"0.1",min:"0",max:"20",value:v.defaults.promotionPercentage||"",onChange:e=>eh("promotionPercentage",parseFloat(e.target.value)||2),placeholder:"2.0",className:"w-32 bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]})]})]}),(0,n.jsxs)("div",{className:"bg-slate-800 rounded-md shadow-md p-6 mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-slate-100 mb-4",children:"AI Assist"}),(0,n.jsx)("p",{className:"text-sm text-slate-400 mb-6",children:"Configure how AI Assist handles different listing tasks. These settings allow you to refine and improve AI Assist over time—correct recurring mistakes, add context it can't infer from photos, and adapt to your specific workflow."}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-2",children:"Listing Style"}),(0,n.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Controls how AI Assist writes titles, descriptions, and condition descriptions. Choose a preset that matches your brand voice, or create your own style guide."}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)(G,{options:Y.listingStyle.map(e=>({id:e.id,label:e.label})),value:(null==(g=Y.listingStyle.find(e=>{var t,s;return e.id===(null==(s=v.taskInstructions)||null==(t=s.listingStyle)?void 0:t.preset)}))?void 0:g.label)||null,onChange:e=>{let t=Y.listingStyle.find(t=>t.label===e);t&&em("listingStyle",t.id)},isMulti:!1,allowCustom:!1,placeholder:"Select listing style..."}),(null==(f=v.taskInstructions)?void 0:f.listingStyle)&&(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsx)(ec,{value:ei,onChange:e=>{"custom"===v.taskInstructions.listingStyle.preset&&em("listingStyle","custom",e.target.value)},readOnly:"custom"!==v.taskInstructions.listingStyle.preset,placeholder:"Enter custom instructions...",maxLength:2500,className:"w-full ".concat("custom"===v.taskInstructions.listingStyle.preset?"bg-slate-700":"bg-slate-700/50"," text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 min-h-[100px] ").concat("custom"!==v.taskInstructions.listingStyle.preset?"cursor-not-allowed":"")})})]}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-2 mt-8",children:"Pricing Strategy"}),(0,n.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Controls how AI Assist suggests prices for your listings. Choose a strategy that aligns with your business model—whether you prioritize quick sales or maximum profit."}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)(G,{options:Y.pricingStrategy.map(e=>({id:e.id,label:e.label})),value:(null==(b=Y.pricingStrategy.find(e=>{var t,s;return e.id===(null==(s=v.taskInstructions)||null==(t=s.pricingStrategy)?void 0:t.preset)}))?void 0:b.label)||null,onChange:e=>{let t=Y.pricingStrategy.find(t=>t.label===e);t&&em("pricingStrategy",t.id)},isMulti:!1,allowCustom:!1,placeholder:"Select pricing strategy..."}),(null==(y=v.taskInstructions)?void 0:y.pricingStrategy)&&(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsx)(ec,{value:ed,onChange:e=>{"custom"===v.taskInstructions.pricingStrategy.preset&&em("pricingStrategy","custom",e.target.value)},readOnly:"custom"!==v.taskInstructions.pricingStrategy.preset,placeholder:"Enter custom instructions...",maxLength:2500,className:"w-full ".concat("custom"===v.taskInstructions.pricingStrategy.preset?"bg-slate-700":"bg-slate-700/50"," text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 min-h-[100px] ").concat("custom"!==v.taskInstructions.pricingStrategy.preset?"cursor-not-allowed":"")})})]}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-2 mt-8",children:"General Instructions"}),(0,n.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Optional instructions applied to all AI Assist tasks. Use this for universal requirements like standard closing phrases, disclaimers, or brand messaging that should appear in every listing. Refine this over time as you notice patterns in what AI Assist consistently needs reminding about."}),(0,n.jsx)(ec,{value:v.generalInstructions||"",onChange:e=>eu({generalInstructions:e.target.value}),placeholder:"Example: Always end descriptions with 'Thank you for shopping with us!' or include standard disclaimers...",maxLength:5e3,className:"w-full bg-slate-700 text-slate-100 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 min-h-[100px]"}),(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-200 mb-2 mt-8",children:"Category Instructions"}),(0,n.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:'Add custom AI Assist instructions for specific categories. Perfect for preventing recurring mistakes, adding context that\'s universal to all items in that category, or including standard work you always do. For example: "All motherboards have been fitted with new CMOS batteries" saves you from mentioning this in notes every time.'}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Add Category"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(el,{value:J,onChange:K})}),(0,n.jsx)("button",{onClick:()=>{if(J){if(v.categoryInstructions.some(e=>e.category.id===J.id))return void alert("This category already has instructions. Edit the existing one below.");eu({categoryInstructions:[...v.categoryInstructions,{category:J,instructions:""}]}),K(null)}},disabled:!J,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white rounded-lg shadow transition-colors",children:"Add"})]})]}),v.categoryInstructions.length>0?(0,n.jsx)("div",{className:"space-y-4",children:v.categoryInstructions.map((e,t)=>(0,n.jsxs)("div",{className:"bg-slate-700 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("div",{className:"text-slate-100 font-medium truncate",children:e.category.name}),(0,n.jsx)("div",{className:"text-slate-400 text-xs truncate",children:e.category.path})]}),(0,n.jsx)("button",{onClick:()=>Q(t),className:"ml-2 text-slate-400 hover:text-red-400 transition-colors",title:"Remove category",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,n.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),(0,n.jsx)(ec,{value:e.instructions,onChange:e=>((e,t)=>{let s=[...v.categoryInstructions];s[e]={...s[e],instructions:t},eu({categoryInstructions:s})})(t,e.target.value),placeholder:"Enter AI instructions for this category...",maxLength:2500,className:"w-full bg-slate-600 text-slate-100 border border-slate-500 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 min-h-[76px]"})]},t))}):(0,n.jsx)("div",{className:"bg-slate-700/50 rounded-lg p-4 text-center text-slate-400 text-sm",children:"No category instructions added yet"})]})]}),(0,n.jsx)(N.A,{isOpen:null!==X,onClose:()=>Q(null),onConfirm:()=>{eu({categoryInstructions:v.categoryInstructions.filter((e,t)=>t!==X)}),Q(null)},title:"Remove Category Instructions",message:"Are you sure you want to remove the instructions for this category?",confirmText:"Remove",type:"confirm"}),ee&&(0,n.jsx)(N.A,{isOpen:!0,onClose:()=>et(null),onConfirm:()=>{if(ee)try{ep();let e=(0,r.Px)()[ee];if(!e){console.error("Account ".concat(ee," not found in pool")),et(null);return}(0,r.O5)(e),localStorage.removeItem("inventory_syncData"),window.location.reload()}catch(e){console.error("Failed to switch account:",e),et(null)}},title:"Switch Account",message:'Switch to account "'.concat(ee,'"?'),confirmText:"Switch",cancelText:"Cancel",type:"confirm"}),Z&&(0,n.jsx)(N.A,{isOpen:!0,onClose:()=>$(!1),onConfirm:()=>{let e=(0,r._9)();if(!(null==e?void 0:e.username))return void $(!1);try{ep();let t=(0,r.Px)();delete t[e.username];let s=Object.keys(t);s.length>0?(0,r.O5)(t[s[0]]):(0,r.O5)(null),(0,r.H1)(t),localStorage.removeItem("inventory_syncData"),window.location.reload()}catch(e){console.error("Failed to logout account:",e),$(!1)}},title:"Logout Account",message:'Logout account "'.concat(null==(j=(0,r._9)())?void 0:j.username,'"?'),confirmText:"Logout",cancelText:"Cancel",type:"confirm"})]})}let eg=(0,i.F)({activeView:null});function ef(){let{activeView:e,setActiveView:t}=eg(),{setShowHelp:s}=o(),r=(0,l.useSearchParams)(),i=(0,l.useRouter)();return((0,a.useEffect)(()=>{let e=r.get("view");e&&["research","notes","inventory","drafts","settings"].includes(e)?t(e):t("notes")},[]),(0,a.useEffect)(()=>{if(!e)return;let t=new URLSearchParams(r);t.set("view",e);let s=window.location.hash;i.replace("?".concat(t.toString()).concat(s)),document.title=e.charAt(0).toUpperCase()+e.slice(1)},[e,r,i]),e)?(0,n.jsxs)("div",{className:"h-dvh flex flex-col",children:[(0,n.jsxs)("div",{className:"bg-slate-800 rounded-md shadow-md p-3 shrink-0 m-4 mb-4",children:[(0,n.jsx)("div",{className:"research"===e?"block":"hidden",children:(0,n.jsx)(T,{})}),(0,n.jsx)("div",{className:"notes"===e?"block":"hidden",children:(0,n.jsx)(g,{})}),(0,n.jsx)("div",{className:"inventory"===e?"block":"hidden",children:(0,n.jsx)(H,{})}),(0,n.jsx)("div",{className:"drafts"===e?"block":"hidden",children:(0,n.jsx)(K,{})}),(0,n.jsx)("div",{className:"settings"===e?"block":"hidden",children:(0,n.jsx)(ex,{})})]}),(0,n.jsxs)("div",{className:"flex-1 min-h-0 overflow-auto relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 ".concat("research"===e?"block":"hidden"),children:(0,n.jsx)(F,{})}),(0,n.jsx)("div",{className:"absolute inset-0 ".concat("notes"===e?"block":"hidden"),children:(0,n.jsx)(A,{})}),(0,n.jsx)("div",{className:"absolute inset-0 ".concat("inventory"===e?"block":"hidden"),children:(0,n.jsx)(q,{})}),(0,n.jsx)("div",{className:"absolute inset-0 ".concat("drafts"===e?"block":"hidden"),children:(0,n.jsx)(em,{})}),(0,n.jsx)("div",{className:"absolute inset-0 ".concat("settings"===e?"block":"hidden"),children:(0,n.jsx)(ep,{})})]}),(0,n.jsxs)("footer",{className:"text-center text-slate-500 text-xs py-1 shrink-0",children:["Copyright Andrew Spode of"," ",(0,n.jsx)("a",{href:"https://spodesabode.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Spode's Abode"})]})]}):null}function eb(){return(0,n.jsx)(a.Suspense,{fallback:(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-900",children:(0,n.jsx)("div",{className:"bg-slate-800 p-8 rounded-md shadow-md text-slate-100",children:"Loading..."})}),children:(0,n.jsx)(h,{children:(0,n.jsx)(ef,{})})})}},6784:(e,t,s)=>{s.d(t,{F:()=>r});var n=s(1521),l=s(2557),a=s.n(l);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{store:s=!1,compress:l=!1,namespace:r}=t;if(s&&!r)throw Error("namespace is required when store=true to prevent localStorage collisions");let i=Object.keys(e),o={},c={};return i.forEach(t=>{o[t]=e[t],c[t]=new Set}),function(){let e={},t={},[d,u]=(0,n.useState)(s);Math.random().toString(36).substr(2,9),i.forEach(s=>{let[l,a]=(0,n.useState)(o[s]);e[s]=l,t[s]=a,(0,n.useEffect)(()=>(c[s].add(a),l!==o[s]&&a(o[s]),()=>{c[s].delete(a)}),[])}),(0,n.useEffect)(()=>{s&&(i.forEach(e=>{let t="".concat(r,"_").concat(e),s=localStorage.getItem(t);if(s)try{let t=l?JSON.parse(a().decompress(s)):JSON.parse(s);null!=t&&(o[e]=t,c[e].forEach(e=>e(t)))}catch(e){console.warn("Failed to parse ".concat(t,":"),e)}}),setTimeout(()=>{u(!1)},1e3))},[]);let h={};return i.forEach(e=>{h["set".concat(e.charAt(0).toUpperCase()+e.slice(1))]=(0,n.useCallback)(t=>{let n="function"==typeof t?t(o[e]):t;if(o[e]=n,c[e].forEach(e=>{e(n)}),s){let t="".concat(r,"_").concat(e);if(null==n)localStorage.removeItem(t);else{let e=JSON.stringify(n),s=l?a().compress(e):e;localStorage.setItem(t,s)}}},[])}),(0,n.useEffect)(()=>{if(!s)return;let e=e=>{if(i.map(e=>"".concat(r,"_").concat(e)).includes(e.key)&&e.newValue){let t=e.key.replace("".concat(r,"_"),"");try{let s=l?JSON.parse(a().decompress(e.newValue)):JSON.parse(e.newValue);o[t]=s,c[t].forEach(e=>e(s))}catch(t){console.warn("Failed to parse storage change for ".concat(e.key,":"),t)}}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),{...e,...h,isLoading:d}}}},9949:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(3365),l=s(1521),a=s(3452),r=s(1691);function i(e){let{categoryName:t,categoryTotal:s,selectedFilters:i,filteredItems:o,searchText:c,onToggleFilter:d,onClearFilters:u,onClearSearch:h,onClearCategory:m,isShopMode:x=!1,accountType:p="INDIVIDUAL"}=e,[g,f]=(0,l.useState)(10),[b,y]=(0,l.useState)("recent"),[w,j]=(0,l.useState)(!1),[v,k]=(0,l.useState)(null),[N,C]=(0,l.useState)("description"),[S,L]=(0,l.useState)([]),[I,A]=(0,l.useState)(0),E=(0,l.useRef)(null),T=(0,l.useRef)(null),M=(0,l.useRef)(null),D=(0,l.useRef)(!1),P=(0,l.useRef)(o.length);(0,l.useEffect)(()=>{P.current!==o.length&&(f(10),M.current&&(M.current.scrollTop=0)),P.current=o.length},[o.length]),(0,l.useEffect)(()=>{f(10),M.current&&(M.current.scrollTop=0)},[b]),(0,l.useEffect)(()=>{if(o.length<=g)return;let e=M.current;if(!e)return;let t=()=>{if(!D.current)e.scrollTop+e.clientHeight>e.scrollHeight-200&&(D.current=!0,f(e=>e+10),D.current=!1)};return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}},[g,o.length]);let B=e=>"string"==typeof e&&e.includes("ebayimg.com")?e.replace(/(\$_)(\d+)(\.[A-Za-z]+)(\?|$)/,"$157$3$4"):e,R=e=>{if(e.pictureURLs&&e.pictureURLs.length>0){let t=e.pictureURLs.map(B);k(e),L(t),A(0),C("gallery"),j(!0)}},O=e=>{k(e),C("description"),j(!0)},F=()=>{(null==v?void 0:v.pictureURLs)&&v.pictureURLs.length>0&&(L(v.pictureURLs.map(B)),A(0),C("gallery"))},_=()=>{C("description")},U=()=>{A(e=>e===S.length-1?0:e+1)},z=()=>{A(e=>0===e?S.length-1:e-1)},W=()=>{j(!1),k(null)},H=e=>{if(w)switch(e.key){case"ArrowLeft":"gallery"===N&&(z(),e.preventDefault());break;case"ArrowRight":"gallery"===N&&(U(),e.preventDefault());break;case"Tab":"gallery"===N?_():F(),e.preventDefault();break;case"Escape":W(),e.preventDefault()}};(0,l.useEffect)(()=>{if(w)return window.addEventListener("keydown",H),()=>{window.removeEventListener("keydown",H)}},[w,I,S.length,N]),(0,l.useEffect)(()=>{let e="#modal"===window.location.hash;w&&!e?history.pushState(null,"",window.location.pathname+window.location.search+"#modal"):!w&&e&&history.back()},[w]),(0,l.useEffect)(()=>{let e=e=>{"#modal"!==window.location.hash&&w&&W()};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[w]);let V=e=>{let{name:t,value:s}=e,l=Array.isArray(s)?s.join(", "):s;return(0,n.jsxs)("div",{className:"inline-flex items-center bg-slate-700 text-xs rounded px-2 py-1",children:[(0,n.jsxs)("span",{className:"mr-1 text-blue-300",children:[t,":"]}),(0,n.jsx)("span",{className:"text-slate-300",children:l})]})},{setActiveView:q}=(0,a.usePageState)(),{setTriggerSearch:G}=(0,r.O)(),Y=e=>{G(e.title),q("research")},J=e=>{let{item:t,onImageClick:s,onTitleClick:l,transparent:a=!1,isShopMode:r=!1,accountType:i="INDIVIDUAL"}=e,o=parseFloat(t.price)||0,c="BUSINESS"===i,d=c?0:(e=>{let t,s=parseFloat(e)||0;return t=.1+.07*Math.min(s,20),s>20&&(t+=.04*Math.min(s-20,280)),s>300&&(t+=.02*Math.min(s-300,3700)),t})(o),u=c?o:(e=>{let t=Math.floor(e),s=e-t;return .01>Math.abs(s-.49)||.01>Math.abs(s-.99)?e:[t-1+.99,t+.49,t+.99].reduce((t,s)=>Math.abs(s-e)<Math.abs(t-e)?s:t)})(o+d),h=null;return t.specifics&&(h=Object.entries(t.specifics).map((e,t)=>{let[s,l]=e;return(0,n.jsx)(V,{name:s,value:l},t)})),(0,n.jsxs)("div",{className:"".concat(a?"bg-transparent":"bg-slate-800"," py-2 rounded-md mb-4"),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("div",{className:"relative ml-0 mr-4",children:[(0,n.jsx)("img",{src:t.pictureURLs[0],alt:"Product image loading...",title:t.title,className:"w-24 h-24 sm:w-40 sm:h-40 object-cover rounded-md cursor-pointer hover:opacity-90 transition-opacity",loading:"lazy",onClick:()=>s&&s(t)}),t.pictureURLs.length>1&&(0,n.jsx)("div",{className:"absolute top-1 right-1 bg-slate-800 bg-opacity-70 text-white text-xs rounded-full p-1",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"9",y:"3",width:"12",height:"12",rx:"2",ry:"2"}),(0,n.jsx)("rect",{x:"3",y:"9",width:"12",height:"12",rx:"2",ry:"2"})]})})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-white font-medium group",children:(0,n.jsx)("span",{onClick:()=>l&&l(t),className:"hover:text-blue-300 cursor-pointer transition-colors duration-200",title:"View details",children:t.title})}),(0,n.jsxs)("p",{className:"text-slate-400 text-sm",children:[(0,n.jsxs)("span",{className:"text-green-400",children:["\xa3",u.toFixed(2)]}),!c&&(0,n.jsxs)("span",{className:"text-slate-500 text-xs",children:[" (\xa3",o.toFixed(2)," + \xa3",d.toFixed(2)," buyer's fee)"]})]})]}),(h||!r)&&(0,n.jsxs)("div",{className:"hidden sm:flex sm:flex-wrap mt-2 gap-1",children:[!r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{href:"https://www.ebay.co.uk/lstng?mode=ReviseItem&itemId=".concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center bg-blue-700 text-white text-xs rounded px-2 py-1 hover:bg-blue-600 transition-colors duration-200",title:"Edit on eBay",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,n.jsx)("a",{href:"https://www.ebay.co.uk/itm/".concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center bg-green-700 text-white text-xs rounded px-2 py-1 hover:bg-green-600 transition-colors duration-200",title:"View on eBay",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M10 6H6a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),(0,n.jsx)("button",{onClick:()=>Y(t),className:"inline-flex items-center bg-purple-700 text-white text-xs rounded px-2 py-1 hover:bg-purple-600 transition-colors duration-200",title:"Research this item",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("path",{d:"m21 21-4.35-4.35"})]})})]}),h&&h]})]})]}),(h||!r)&&(0,n.jsxs)("div",{className:"sm:hidden mt-2 mx-0 flex flex-wrap gap-1",children:[!r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{href:"https://www.ebay.co.uk/lstng?mode=ReviseItem&itemId=".concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center bg-blue-700 text-white text-xs rounded px-2 py-1 hover:bg-blue-600 transition-colors duration-200",title:"Edit on eBay",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,n.jsx)("a",{href:"https://www.ebay.co.uk/itm/".concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center bg-green-700 text-white text-xs rounded px-2 py-1 hover:bg-green-600 transition-colors duration-200",title:"View on eBay",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M10 6H6a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),(0,n.jsx)("button",{onClick:()=>Y(t),className:"inline-flex items-center bg-purple-700 text-white text-xs rounded px-2 py-1 hover:bg-purple-600 transition-colors duration-200",title:"Research this item",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.jsx)("path",{d:"m21 21-4.35-4.35"})]})})]}),h&&h]})]})};return(0,n.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,n.jsxs)("div",{className:"mb-3 flex justify-between items-center flex-shrink-0",children:[(0,n.jsxs)("button",{onClick:()=>window.dispatchEvent(new CustomEvent("switch-to-filters")),className:"sm:hidden px-2 py-1.5 rounded bg-blue-600 hover:bg-blue-500 text-white flex-shrink-0 flex items-center",title:"Back to filters",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"mr-1",children:(0,n.jsx)("polyline",{points:"15 18 9 12 15 6"})}),(0,n.jsx)("span",{className:"text-xs font-medium",children:"Filters"})]}),o.length>1&&(0,n.jsxs)("select",{value:b,onChange:e=>y(e.target.value),className:"text-xs p-1.5 bg-slate-700 text-white border border-slate-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"recent",children:"Recent First"}),(0,n.jsx)("option",{value:"oldestFirst",children:"Oldest First"}),(0,n.jsx)("option",{value:"priceAsc",children:"Price: Low to High"}),(0,n.jsx)("option",{value:"priceDesc",children:"Price: High to Low"})]})]}),((null==c?void 0:c.trim())||t&&"any"!==t||Object.keys(i).length>0)&&(0,n.jsxs)("div",{className:"mb-3 relative",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-hide flex-shrink-0",children:[+(null!=c&&!!c.trim())+ +("any"!==t)+Object.keys(i).length>0&&(0,n.jsx)("button",{onClick:()=>{h(),m(),u()},className:"px-2 py-1.5 rounded-md bg-slate-700 hover:bg-slate-800 text-slate-200 hover:text-slate-400 flex-shrink-0",title:"Clear all filters",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M3 6h18"}),(0,n.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,n.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})}),(null==c?void 0:c.trim())&&(0,n.jsxs)("div",{className:"inline-flex items-center bg-blue-700 text-white text-sm rounded px-3 py-1.5 flex-shrink-0",children:[(0,n.jsx)("span",{className:"mr-1 text-blue-200",children:"Search:"}),c,(0,n.jsx)("button",{onClick:h,className:"ml-2 text-blue-300 hover:text-white",children:"\xd7"})]}),"any"!==t&&(0,n.jsxs)("div",{className:"inline-flex items-center bg-blue-700 text-white text-sm rounded px-3 py-1.5 flex-shrink-0",children:[(0,n.jsx)("span",{className:"mr-1 text-blue-200",children:"Category:"}),t,(0,n.jsx)("button",{onClick:m,className:"ml-2 text-blue-300 hover:text-white",children:"\xd7"})]}),Object.entries(i).map(e=>{let[t,s]=e;return s.map((e,s)=>(0,n.jsxs)("div",{className:"inline-flex items-center bg-blue-700 text-white text-sm rounded px-3 py-1.5 flex-shrink-0 ".concat(s>0?"border-l-2 border-blue-400 -ml-1.5":""),children:[0===s&&(0,n.jsxs)("span",{className:"mr-1 text-blue-200",children:[t,":"]}),e,(0,n.jsx)("button",{onClick:()=>d(t,e),className:"ml-2 text-blue-300 hover:text-white",children:"\xd7"})]},"".concat(t,"-").concat(e)))})]}),(0,n.jsx)("div",{className:"absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-slate-800 to-transparent pointer-events-none"})]}),(0,n.jsx)("div",{className:"mb-0 text-sm text-slate-400 flex-shrink-0",children:t&&s&&o.length!==s?(0,n.jsxs)("span",{children:["Showing ",(0,n.jsx)("span",{className:"text-green-400",children:o.length}),"\xa0/\xa0",(0,n.jsx)("span",{className:"text-blue-400",children:s})," matches"]}):(0,n.jsxs)("span",{children:["Showing ",(0,n.jsx)("span",{className:"text-green-400",children:o.length})," matches"]})}),(0,n.jsxs)("div",{ref:M,className:"space-y-2 pr-4 flex-grow overflow-y-auto custom-scrollbar pt-0",children:[(()=>{let e=[...o];switch(b){case"priceAsc":return e.sort((e,t)=>parseFloat(e.price)-parseFloat(t.price));case"priceDesc":return e.sort((e,t)=>parseFloat(t.price)-parseFloat(e.price));case"oldestFirst":return e.sort((e,t)=>e.id.localeCompare(t.id));default:return e.sort((e,t)=>t.id.localeCompare(e.id))}})().slice(0,g).map(e=>(0,n.jsx)(J,{item:e,onImageClick:R,onTitleClick:O,isShopMode:x,accountType:p},e.id)),o.length>g&&(0,n.jsx)("div",{className:"py-4 text-center text-slate-400 text-sm",children:"Loading more items..."})]}),w&&v&&(0,n.jsxs)("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-95 z-50 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex-shrink-0 bg-slate-800 bg-opacity-90 border-b border-slate-600",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-4 pb-2",children:[(0,n.jsx)("h2",{className:"text-lg font-medium text-white truncate flex-1 pr-4",children:v.title}),(0,n.jsx)("button",{className:"text-slate-400 hover:text-white flex-shrink-0 p-1",onClick:W,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 px-4 pb-4",children:[v.pictureURLs&&v.pictureURLs.length>0&&(0,n.jsxs)("button",{onClick:F,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm flex items-center gap-1",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,n.jsx)("circle",{cx:"9",cy:"9",r:"2"}),(0,n.jsx)("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),"Photos"]}),(0,n.jsxs)("button",{onClick:_,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm flex items-center gap-1",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,n.jsx)("polyline",{points:"14,2 14,8 20,8"}),(0,n.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,n.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),(0,n.jsx)("polyline",{points:"10,9 9,9 8,9"})]}),"Details"]}),(0,n.jsxs)("a",{href:"https://www.ebay.co.uk/itm/".concat(v.id),target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded text-sm flex items-center gap-1",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"eBay"]})]})]}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:"gallery"===N?(0,n.jsxs)("div",{className:"relative h-full",children:[(0,n.jsxs)("div",{className:"absolute inset-0 pb-40 md:pb-32 flex items-center justify-center",children:[(0,n.jsx)("button",{className:"hidden md:flex bg-black bg-opacity-50 rounded-full p-2 text-white hover:bg-opacity-70 transition-opacity cursor-pointer absolute left-4 z-20",onClick:z,"aria-label":"Previous image",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,n.jsx)("img",{src:S[I],alt:"Gallery image ".concat(I+1),className:"object-contain cursor-pointer",style:{maxWidth:"100%",maxHeight:"100%"},onClick:U,onTouchStart:e=>{E.current=e.touches[0].clientX},onTouchMove:e=>{T.current=e.touches[0].clientX},onTouchEnd:()=>{if(!E.current||!T.current)return;let e=T.current-E.current;Math.abs(e)>50&&(e>0?z():U()),E.current=null,T.current=null}})}),(0,n.jsx)("button",{className:"hidden md:flex bg-black bg-opacity-50 rounded-full p-2 text-white hover:bg-opacity-70 transition-opacity cursor-pointer absolute right-4 z-20",onClick:U,"aria-label":"Next image",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]}),(0,n.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-800",children:[(0,n.jsx)("div",{className:"w-full md:hidden py-4",children:(0,n.jsxs)("div",{className:"flex justify-center items-center gap-8 mb-3",children:[(0,n.jsx)("button",{className:"bg-black bg-opacity-50 rounded-full p-2 text-white hover:bg-opacity-70 transition-opacity cursor-pointer",onClick:z,"aria-label":"Previous image",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,n.jsxs)("div",{className:"bg-black bg-opacity-60 text-white px-4 py-2 rounded-full text-sm",children:[I+1," / ",S.length]}),(0,n.jsx)("button",{className:"bg-black bg-opacity-50 rounded-full p-2 text-white hover:bg-opacity-70 transition-opacity cursor-pointer",onClick:U,"aria-label":"Next image",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("polyline",{points:"9 18 15 12 9 6"})})})]})}),S.length>1&&(0,n.jsx)("div",{className:"w-full overflow-hidden py-3 border-t border-slate-700",children:(0,n.jsx)("div",{className:"flex justify-start md:justify-center items-center gap-2 overflow-x-auto px-2 w-full scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent whitespace-nowrap",children:S.map((e,t)=>(0,n.jsx)("button",{onClick:()=>A(t),className:"w-14 h-14 flex-shrink-0 rounded-md overflow-hidden \n                              ".concat(t===I?"ring-2 ring-blue-500":"opacity-70 hover:opacity-100"),children:(0,n.jsx)("img",{src:e,alt:"Thumbnail ".concat(t+1),className:"w-full h-full object-cover"})},t))})}),(0,n.jsx)("div",{className:"hidden md:flex justify-center py-2",children:(0,n.jsxs)("div",{className:"bg-black bg-opacity-60 text-white px-4 py-2 rounded-full text-sm",children:[I+1," / ",S.length]})})]})]}):(0,n.jsx)("div",{className:"h-full flex flex-col",children:(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,n.jsx)(J,{item:v,onImageClick:F,transparent:!0,isShopMode:x,accountType:p}),(0,n.jsx)("div",{className:"text-slate-300 max-w-none [&_p]:mb-4 [&_hr]:my-6 [&_hr]:border-slate-600",dangerouslySetInnerHTML:{__html:(e=>{if(!e)return"No description available";let t=document.createElement("div");t.innerHTML=e;let s=e=>{if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeType===Node.ELEMENT_NODE){let t=e.tagName.toLowerCase(),n="";for(let t of e.childNodes)n+=s(t);if("br"===t)return"<br>";if("hr"===t)return"<hr>";if("p"===t)return n?"<p>".concat(n,"</p>"):"";else if("div"===t)return n?"<div>".concat(n,"</div>"):"";let l=e.style||{},a=window.getComputedStyle?window.getComputedStyle(e):{},r="700"===l.fontWeight||"bold"===l.fontWeight||"700"===a.fontWeight||"bold"===a.fontWeight||"b"===t||"strong"===t,i="italic"===l.fontStyle||"italic"===a.fontStyle||"i"===t||"em"===t;return r&&i?"<strong><em>".concat(n,"</em></strong>"):r?"<strong>".concat(n,"</strong>"):i?"<em>".concat(n,"</em>"):n}return""};return s(t)})(v.description)}})]})})})]})]})}function o(e){let{attrName:t,attrData:s,selectedAttribute:l,selectedFilters:a,onSelectAttribute:r,onToggleFilter:i}=e,o=l===t;return(0,n.jsxs)("div",{className:"bg-slate-800 py-1 rounded-md mb-1",children:[(0,n.jsxs)("h3",{className:"text-white font-medium mb-1 cursor-pointer hover:text-blue-400",onClick:()=>r(o?null:t),children:[t,(0,n.jsx)("span",{className:"float-right text-sm",children:o?"▼":"▶"})]}),o&&(0,n.jsx)("div",{className:"mt-1 space-y-0.5",children:Object.entries(s.values).sort((e,t)=>"Not Set"===e[0]?-1:"Not Set"===t[0]?1:e[0].localeCompare(t[0])).map(e=>{var l;let[r,o]=e,c=Math.round(o.count/s.totalInCategory*100),d=(null==(l=a[t])?void 0:l.includes(r))||!1,u="Not Set"===r;return(0,n.jsxs)("div",{className:"flex items-center py-0.5 px-2 rounded-sm cursor-pointer ".concat(d?"bg-blue-700":"hover:bg-slate-700"),onClick:()=>i(t,r),children:[(0,n.jsx)("span",{className:"".concat(d?"text-white":"text-slate-300"," text-sm truncate flex-grow ").concat(u?"italic":""),children:r}),(0,n.jsxs)("div",{className:"flex items-center flex-shrink-0 w-32",children:[(0,n.jsx)("div",{className:"w-14 bg-slate-700 rounded-full h-1.5 mr-2",children:(0,n.jsx)("div",{className:"".concat(d?"bg-blue-300":u?"bg-orange-500":"bg-blue-500"," h-1.5 rounded-full"),style:{width:"".concat(c,"%")}})}),(0,n.jsx)("span",{className:"text-xs ".concat(d?"text-blue-200":"text-slate-400"," w-14 text-right"),children:o.count})]})]},r)})})]})}function c(e){let{items:t,isShopMode:s=!1,onShowInfo:a,accountType:r="INDIVIDUAL"}=e,[o,c]=(0,l.useState)(null),[u,h]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[p,g]=(0,l.useState)({}),[f,b]=(0,l.useState)(null),[y,w]=(0,l.useState)([]),[j,v]=(0,l.useState)(!1),[k,N]=(0,l.useState)(""),[C,S]=(0,l.useState)(""),[L,I]=(0,l.useState)(0);(0,l.useEffect)(()=>{t&&c(t)},[t]);let A=(0,l.useRef)(null),E=()=>{S(""),N(""),A.current&&clearTimeout(A.current)};(0,l.useEffect)(()=>{let e,t;if(!o)return;let s=m||"any",n=o;if(k.trim()){let e=k.toLowerCase().trim().split(/\s+/).filter(e=>e.length>0),t={},s={};Object.entries(o.items).forEach(n=>{let[l,a]=n;a.searchText&&e.every(e=>a.searchText.includes(e))&&(t[l]=a,Object.entries(o.itemsByCategory).forEach(e=>{let[t,n]=e;n.includes(l)&&(s[t]||(s[t]=[]),s[t].push(l))}))}),n={...o,items:t,itemsByCategory:s}}if("any"===s)e=Object.keys(n.items),t="All Categories";else{let[l,a]=s.split(":");t=a,e=n.itemsByCategory[s]||[]}let l={productType:t,listingCount:e.length,attributes:{}},a={};e.forEach(e=>{let t=n.items[e];t&&t.specifics&&Object.entries(t.specifics).forEach(s=>{let[n,l]=s;l&&(a[n]||(a[n]={values:{},totalInCategory:0,uniqueItemsWithAttribute:new Set}),a[n].uniqueItemsWithAttribute.add(e),(Array.isArray(l)?l:[l]).forEach(s=>{if(!s)return;let l=s.toString().trim();a[n].values[l]||(a[n].values[l]={count:0,listings:[]}),a[n].values[l].count++,a[n].totalInCategory++,a[n].values[l].listings.some(t=>t.id===e)||a[n].values[l].listings.push({id:e,title:t.title,price:t.price,pictureURLs:t.pictureURLs})}))})}),Object.keys(a).forEach(t=>{let s=a[t];s.uniqueItemCount=s.uniqueItemsWithAttribute.size;let l=e.length-s.uniqueItemCount;l>0&&(s.values["Not Set"]={count:l,listings:e.filter(e=>!s.uniqueItemsWithAttribute.has(e)).map(e=>{let t=n.items[e];return{id:e,title:t.title,price:t.price,pictureURLs:t.pictureURLs}})},s.totalInCategory+=l),delete s.uniqueItemsWithAttribute}),l.attributes=a,h(l),w(e.map(e=>n.items[e]))},[o,m,k]),(0,l.useEffect)(()=>{b(null),g({})},[m,k]),(0,l.useEffect)(()=>{let e;if(!o)return void w([]);if(k.trim()){let t=k.toLowerCase().trim().split(/\s+/).filter(e=>e.length>0);e=Object.keys(o.items).filter(e=>{let s=o.items[e];return!!s.searchText&&t.every(e=>s.searchText.includes(e))})}else{let t=m||"any";e="any"===t?Object.keys(o.items):o.itemsByCategory[t]||[]}let t=e,s=m||"any";if(k.trim()&&"any"!==s){let n=o.itemsByCategory[s]||[];t=e.filter(e=>n.includes(e))}Object.keys(p).length>0&&(t=t.filter(e=>{let t=o.items[e];return!!t&&!!t.specifics&&Object.entries(p).every(e=>{let[s,n]=e;if(0===n.length)return!0;let l=n.includes("Not Set"),a=n.some(e=>"Not Set"!==e),r=t.specifics[s],i=!r;if(l&&!a)return i;if(l&&a){if(i)return!0;let e=Array.isArray(r)?r:[r];return n.some(t=>"Not Set"!==t&&e.some(e=>e.toString().trim()===t))}if(!l){if(i)return!1;let e=Array.isArray(r)?r:[r];return n.some(t=>e.some(e=>e.toString().trim()===t))}return!1})})),w(t.map(e=>o.items[e]))},[o,k,m,p]);let T=(e,t)=>{g(s=>{let n={...s};return n[e]||(n[e]=[]),n[e].includes(t)?(n[e]=n[e].filter(e=>e!==t),0===n[e].length&&delete n[e]):n[e]=[...n[e],t],n})},M=e=>{b(null),g({}),x(e),e&&setTimeout(()=>{P(1)},100)},D=(0,l.useRef)(null),P=e=>{if(D.current){let t=e*window.innerWidth;D.current.scrollTo({left:t,behavior:"smooth"})}};return(0,l.useEffect)(()=>{let e=()=>P(0);window.addEventListener("switch-to-filters",e);let t=e=>{window.innerWidth>=640||"#results"!==window.location.hash&&P(0)},s=()=>{!(window.innerWidth>=640)&&D.current&&I(+(D.current.scrollLeft>0))};window.addEventListener("popstate",t);let n=D.current;return n&&n.addEventListener("scrollend",s),()=>{window.removeEventListener("switch-to-filters",e),window.removeEventListener("popstate",t),n&&n.removeEventListener("scrollend",s)}},[]),(0,l.useEffect)(()=>{if(window.innerWidth>=640)return;let e="#results"===window.location.hash;1!==L||e?0===L&&e&&history.back():history.pushState(null,"",window.location.pathname+window.location.search+"#results")},[L]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{ref:D,className:"flex overflow-x-auto snap-x snap-mandatory w-full h-full",children:[(0,n.jsxs)("div",{className:"snap-start w-full flex-shrink-0 flex-grow-0 bg-slate-800 px-4 pt-4 pb-4 pr-2 rounded-md shadow-md mr-4 sm:mr-4 sm:w-1/3 sm:flex-shrink sm:flex-grow overflow-hidden flex flex-col",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-white",children:"Search & Refine"}),(0,n.jsxs)("div",{className:"flex items-center gap-2 pr-2",children:[s&&a&&(0,n.jsx)("button",{onClick:a,className:"w-7 h-7 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center font-bold text-sm shadow-md",title:"Show information",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("path",{d:"M12 16v-4"}),(0,n.jsx)("path",{d:"M12 8h.01"})]})}),(0,n.jsxs)("button",{onClick:()=>P(1,!0),className:"sm:hidden px-2 py-1.5 rounded bg-green-600 hover:bg-green-500 text-white text-xs font-medium flex items-center",children:[(0,n.jsx)("span",{children:"Results"}),(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"ml-1",children:(0,n.jsx)("polyline",{points:"9 18 15 12 9 6"})})]})]})]}),o?(0,n.jsx)(d,{inventoryData:o,productAttributes:u,selectedProductType:m,selectedFilters:p,selectedAttribute:f,showRareAttributes:j,filteredItems:y,searchText:C,onProductTypeChange:M,onToggleFilter:T,onSelectAttribute:b,onToggleRareAttributes:()=>v(e=>!e),onClearFilters:()=>g({}),onSearchChange:e=>{S(e),A.current&&clearTimeout(A.current),!m&&e.trim()&&x("any"),A.current=setTimeout(()=>{N(e)},300)},onClearSearch:E,onSearchSubmit:()=>{C.trim()&&P(1)},onShowInfo:a,isShopMode:s}):(0,n.jsx)("div",{className:"text-slate-400 text-sm",children:"No Inventory! Do you need to sync?"})]}),(0,n.jsx)("div",{className:"snap-start w-full flex-shrink-0 flex-grow-0 bg-slate-800 px-4 pt-4 pb-4 pr-2 rounded-md shadow-md sm:w-2/3 sm:flex-shrink sm:flex-grow overflow-hidden flex flex-col",children:(0,n.jsx)("div",{className:"flex-grow overflow-y-hidden",children:o?(0,n.jsx)(i,{categoryName:m?m.includes(":")?m.split(":").pop().trim():m:null,categoryTotal:u?u.listingCount:null,selectedFilters:p,filteredItems:y,searchText:k,onToggleFilter:T,onClearFilters:()=>g({}),onClearSearch:E,onClearCategory:()=>M("any"),isShopMode:s,accountType:r}):(0,n.jsx)("div",{className:"text-slate-400 text-sm p-4 bg-slate-700 rounded-md",children:"No Inventory! Do you need to sync?"})})})]})})}function d(e){let{inventoryData:t,productAttributes:s,selectedProductType:l,selectedFilters:a,selectedAttribute:r,showRareAttributes:i,filteredItems:c,searchText:d,onProductTypeChange:u,onToggleFilter:h,onSelectAttribute:m,onToggleRareAttributes:x,onClearFilters:p,onSearchChange:g,onClearSearch:f,onSearchSubmit:b,onShowInfo:y,isShopMode:w}=e;return t?(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"flex-shrink-0 pr-2",children:[(0,n.jsx)("p",{className:"mb-4 text-xs text-slate-400",children:"Use any combination of free text, category and filters."}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b()},className:"relative",children:[(0,n.jsx)("input",{type:"text",value:d,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key&&b()},placeholder:"Search items... (e.g. 'socket 478', 'AGP motherboard', 'ASUS')",className:"w-full p-2 bg-slate-700 text-white rounded border border-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8"}),d&&(0,n.jsx)("button",{type:"button",onClick:f,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white",title:"Clear search",children:"✕"})]})}),(()=>{if(!t||!t.categoryOptions||0===t.categoryOptions.length)return null;let e=(()=>{if(!(null==d?void 0:d.trim()))return null;let e=d.toLowerCase().trim().split(/\s+/).filter(e=>e.length>0),s=new Set;return Object.entries(t.items).forEach(n=>{let[l,a]=n;a.searchText&&e.every(e=>a.searchText.includes(e))&&Object.entries(t.itemsByCategory).forEach(e=>{let[t,n]=e;n.includes(l)&&s.add(t)})}),s})();return(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("select",{value:l||"",onChange:e=>u(e.target.value),className:"w-full p-2 pr-8 bg-slate-800 text-white rounded border border-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500 truncate appearance-none",style:{minWidth:0,backgroundImage:"url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\")",backgroundPosition:"right 0.5rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.5em 1.5em"},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Filter by category..."}),(0,n.jsx)("option",{value:"any",children:"All Categories"}),t.categoryOptions.map(t=>{let s=!e||e.has(t.value),l=t.isGroup||!s&&e;return(0,n.jsx)("option",{value:t.value,disabled:l,className:t.isGroup?"font-bold text-blue-300":"",style:{paddingLeft:t.indent?"".concat(20*t.indent,"px"):"0",color:t.isGroup?"#93c5fd":!s&&e?"#64748b":void 0,opacity:!s&&e?.5:1},children:t.isGroup?"".concat(t.label," (").concat(t.count," items)"):"".concat(t.indent?"└ ":"").concat(t.label," (").concat(t.count,")")},t.value||t.label)})]}),c.length>0&&(0,n.jsxs)("div",{className:"mt-4 mb-4 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"text-sm text-slate-400",children:[(0,n.jsx)("span",{className:"text-green-400",children:c.length})," matching items",s&&c.length!==s.listingCount&&(0,n.jsxs)("span",{children:[" out of ",(0,n.jsx)("span",{className:"text-blue-400",children:s.listingCount})," total"]})]}),Object.keys(a).length>0&&(0,n.jsx)("button",{onClick:p,className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Clear all filters"})]})]})})()]}),(0,n.jsx)("div",{className:"flex-grow overflow-y-auto custom-scrollbar pb-10 pr-2",children:(()=>{if(!s)return null;if(0===Object.keys(s.attributes).length)return(0,n.jsx)("div",{className:"text-slate-400 italic text-sm p-3 bg-slate-800 rounded-md",children:"No detailed attributes found for this product type."});let e=s.listingCount,t=1===e?1:Math.max(2,Math.ceil(.25*e)),l=Object.entries(s.attributes).filter(e=>{let[s,n]=e;return"Category"!==s&&"Product Type"!==s&&(!!i||!(n.uniqueItemCount<t))}).sort((e,t)=>{var s,n;let l=e[1].totalInCategory-((null==(s=e[1].values["Not Set"])?void 0:s.count)||0);return t[1].totalInCategory-((null==(n=t[1].values["Not Set"])?void 0:n.count)||0)-l});if(0===l.length)return(0,n.jsx)("div",{className:"text-slate-400 italic text-sm p-3 bg-slate-800 rounded-md",children:"No attributes to display with current filters."});let c=Object.entries(s.attributes).filter(e=>{let[t,s]=e;return"Category"!==t&&"Product Type"!==t}).filter(e=>{let[s,n]=e;return n.uniqueItemCount<t}).length;return(0,n.jsxs)("div",{children:[l.map(e=>{let[t,s]=e;return(0,n.jsx)(o,{attrName:t,attrData:s,selectedAttribute:r,selectedFilters:a,onSelectAttribute:m,onToggleFilter:h},t)}),c>0&&(0,n.jsx)("div",{className:"p-2 bg-slate-700 rounded-md flex items-center justify-center mt-4",children:(0,n.jsx)("button",{onClick:x,className:"text-blue-300 hover:text-blue-100 text-sm",children:i?"Show fewer attributes":"Show ".concat(c," more attributes")})})]})})()})]}):(0,n.jsx)("div",{children:"Loading data..."})}}}]);